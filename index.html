<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome | IB STUDIOZ</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { 
            --primary: #FFC300; 
            --dark: #121212; 
            --text-primary: #ffffff; 
            --text-secondary: rgba(255, 255, 255, 0.7); 
            --card-bg: rgba(20, 20, 20, 0.5); 
            --border-color: rgba(255, 195, 0, 0.2); 
            --shadow-color: rgba(0, 0, 0, 0.3); 
            --success: #00b09b; 
            --danger: #ff416c; 
            --google: #DB4437;
            --microsoft: #0078D7;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        /* --- KEYFRAME ANIMATIONS --- */
        @keyframes background-pan { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* --- AURORA SHIMMER EFFECT --- */
        @keyframes aurora-shimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body { 
            font-family: "Poppins", sans-serif; 
            background-color: var(--dark); 
            color: var(--text-primary); 
            min-height: 100vh; 
            line-height: 1.6; 
            background-attachment: fixed; 
        }
        .aurora-background { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; 
            background: radial-gradient(ellipse at 10% 10%, var(--primary) 0%, rgba(255, 195, 0, 0) 40%), 
                        radial-gradient(ellipse at 90% 85%, #444 0%, rgba(68, 68, 68, 0) 35%); 
            animation: background-pan 45s linear infinite; 
            opacity: 0.2; 
        }
        .container { max-width: 1200px; margin: 30px auto; padding: 30px; }
        .brand-logo { display: flex; align-items: center; gap: 15px; text-decoration: none; color: var(--text-primary); }
        .brand-logo img { width: 50px; height: auto; }
        .brand-logo h1 { font-size: 1.5rem; font-weight: 600; margin: 0; }

        /* --- BRANDING STYLING --- */
        .brand-title-animated {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(120deg, #ff00c1, #00ffff, #33ff00, #ffc400, #ff00c1);
            background-size: 400% 400%;
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            animation: aurora-shimmer 8s ease-in-out infinite;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }

        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 12px 30px; border-radius: 10px; border: none; font-size: 1rem; font-weight: 500; cursor: pointer; text-align: center; transition: all 0.3s ease; text-decoration: none; }
        .btn-primary { background: var(--primary); color: var(--dark); box-shadow: 0 4px 15px rgba(255, 195, 0, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 195, 0, 0.5); }
        .btn-secondary { background: transparent; color: var(--text-primary); border: 1px solid var(--border-color); }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.1); }
        .btn-small { padding: 8px 15px; font-size: 0.9rem; }
        
        /* Social login buttons */
        .btn-google { background: var(--google); color: white; }
        .btn-microsoft { background: var(--microsoft); color: white; }
        .btn-social { margin: 8px 0; width: 100%; }
        .btn-social i { margin-right: 10px; }
        
        .auth-container { display: flex; justify-content: center; align-items: center; min-height: 90vh; }
        .auth-card { width: 100%; max-width: 450px; text-align: center; background: var(--card-bg); backdrop-filter: blur(15px); border-radius: 15px; border: 1px solid var(--border-color); padding: 40px; box-shadow: 0 8px 32px 0 var(--shadow-color); }
        .auth-card .brand-logo { justify-content: center; margin-bottom: 5px; }
        .auth-subtitle { color: var(--text-secondary); margin-bottom: 30px; font-size: 1rem; }
        #authForm h2 { margin-bottom: 25px; font-weight: 600; }
        .form-group { margin-bottom: 20px; }
        .form-group label { text-align: left; display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-secondary); }
        input, select { width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--border-color); background-color: rgba(0, 0, 0, 0.2); color: var(--text-primary); font-size: 1rem; transition: box-shadow 0.3s ease; }
        input:focus, select:focus { outline: none; box-shadow: 0 0 0 3px var(--primary); border-color: var(--primary); }
        .auth-card .btn { width: 100%; margin-top: 10px; }
        .toggle-auth { margin-top: 25px; color: var(--text-secondary); }
        .toggle-auth a { color: var(--primary); font-weight: 600; text-decoration: none; cursor: pointer; }
        .message { min-height: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9rem; }
        .message.error { color: var(--danger); } .message.success { color: var(--success); }
        .spinner-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; }
        .spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: var(--primary); animation: spin 1s ease-in-out infinite; }
        
        /* Divider */
        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }
        .divider::before, .divider::after {
            content: "";
            flex: 1;
            border-bottom: 1px solid var(--border-color);
        }
        .divider span {
            padding: 0 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Forgot Password Link */
        .forgot-password { 
            text-align: right; 
            margin-top: -10px; 
            margin-bottom: 20px; 
        }
        .forgot-password a { 
            color: var(--primary); 
            font-size: 0.9rem; 
            text-decoration: none; 
            cursor: pointer;
        }
        .forgot-password a:hover { 
            text-decoration: underline; 
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            width: 90%;
            max-width: 450px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 var(--shadow-color);
            transform: translateY(-50px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* --- RESPONSIVE DESIGN --- */
        @media (max-width: 480px) {
            .auth-card { padding: 25px; }
            .brand-logo img { width: 40px; }
            .brand-title-animated { font-size: 1.5rem; }
            .container { padding: 15px; margin: 15px auto; }
            .modal { padding: 20px; }
        }

        .email-display {
            background: rgba(255, 195, 0, 0.1);
            border: 1px solid var(--primary);
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        
        .email-display i {
            color: var(--primary);
            margin-right: 8px;
        }
        
        /* Additional fields for social signup */
        .social-signup-fields {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        /* Form validation styles */
        .form-group.error input, 
        .form-group.error select {
            border-color: var(--danger);
        }
        .error-message {
            color: var(--danger);
            font-size: 0.8rem;
            margin-top: 5px;
            text-align: left;
            display: none;
        }
        .form-group.error .error-message {
            display: block;
        }
    </style>
</head>
<body>
    <div class="aurora-background"></div>
    <div class="container auth-container">
        <div class="auth-card">
            <div class="brand-logo">
                <!-- Improved IB STUDIOZ logo with better "B" -->
                <svg width="50" height="50" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#FFD700" />
                            <stop offset="100%" stop-color="#FFA500" />
                        </linearGradient>
                    </defs>
                    <circle cx="50" cy="50" r="45" fill="url(#goldGradient)" />
                    <!-- Improved "B" letter -->
                    <path d="M30,30 L45,30 C50,30 55,35 55,40 L55,60 C55,65 50,70 45,70 L30,70 Z M35,40 L45,40 C47,40 48,41 48,43 C48,45 47,46 45,46 L35,46 Z M35,54 L45,54 C47,54 48,55 48,57 C48,59 47,60 45,60 L35,60 Z" fill="#121212" />
                    <path d="M60,30 L70,30 L70,45 L65,45 L65,40 L60,40 Z M60,55 L70,55 L70,70 L60,70 Z" fill="#121212" />
                </svg>
                <h1 class="brand-title-animated">IB STUDIOZ</h1>
            </div>
            <p class="auth-subtitle">Online Resources Hub</p>
            <form id="authForm" novalidate>
                <h2 id="form-title">Login</h2>
                <div class="form-group" id="name-group" style="display: none;">
                    <label for="name"><i class="fas fa-user"></i> Full Name</label>
                    <input type="text" id="name" placeholder="Enter your full name">
                    <div class="error-message" id="name-error"></div>
                </div>
                <div class="form-group">
                    <label for="email"><i class="fas fa-envelope"></i> Email Address</label>
                    <input type="email" id="email" placeholder="Enter your email address" required>
                    <div class="error-message" id="email-error"></div>
                </div>
                <div class="form-group" id="admission-group" style="display: none;">
                    <label for="admissionNo"><i class="fas fa-id-card"></i> Admission No</label>
                    <input type="text" id="admissionNo" placeholder="e.g., 717821F123">
                    <div class="error-message" id="admission-error"></div>
                </div>
                <div class="form-group">
                    <label for="password"><i class="fas fa-lock"></i> Password</label>
                    <input type="password" id="password" placeholder="Minimum 6 characters" required>
                    <div class="error-message" id="password-error"></div>
                </div>
                
                <!-- Additional fields for registration -->
                <div id="registration-fields" style="display: none;">
                    <div class="form-group">
                        <label for="branch"><i class="fas fa-graduation-cap"></i> Branch</label>
                        <select id="branch">
                            <option value="">Select your branch</option>
                            <option value="CSE">Computer Science and Engineering</option>
                            <option value="IT">Information Technology</option>
                            <option value="ECE">Electronics and Communication Engineering</option>
                            <option value="EEE">Electrical and Electronics Engineering</option>
                            <option value="MECH">Mechanical Engineering</option>
                            <option value="CIVIL">Civil Engineering</option>
                            <option value="AERO">Aeronautical Engineering</option>
                            <option value="AUTO">Automobile Engineering</option>
                            <option value="BME">Biomedical Engineering</option>
                            <option value="CHEM">Chemical Engineering</option>
                            <option value="IOT">Internet of Things</option>
                            <option value="AI">Artificial Intelligence</option>
                            <option value="DS">Data Science</option>
                            <option value="CSBS">Computer Science and Business Systems</option>
                        </select>
                        <div class="error-message" id="branch-error"></div>
                    </div>
                    <div class="form-group">
                        <label for="semester"><i class="fas fa-calendar-alt"></i> Semester</label>
                        <select id="semester">
                            <option value="">Select your semester</option>
                            <option value="1">Semester 1</option>
                            <option value="2">Semester 2</option>
                            <option value="3">Semester 3</option>
                            <option value="4">Semester 4</option>
                            <option value="5">Semester 5</option>
                            <option value="6">Semester 6</option>
                            <option value="7">Semester 7</option>
                            <option value="8">Semester 8</option>
                        </select>
                        <div class="error-message" id="semester-error"></div>
                    </div>
                </div>
                
                <div class="forgot-password">
                    <a id="forgot-password-link">Forgot Password?</a>
                </div>
                <div id="message-area" class="message"></div>
                <button type="submit" class="btn btn-primary" id="submit-btn">Login</button>
                
                <div class="divider">
                    <span>OR</span>
                </div>
                
                <button type="button" class="btn btn-social btn-google" id="google-login">
                    <i class="fab fa-google"></i> Continue with Google
                </button>
                
                <button type="button" class="btn btn-social btn-microsoft" id="microsoft-login">
                    <i class="fab fa-microsoft"></i> Continue with Microsoft
                </button>
            </form>
            <p class="toggle-auth"><span id="toggle-text">Don't have an account?</span> <a id="toggle-link">Register Now</a></p>
        </div>
    </div>
    
    <!-- Forgot Password Modal -->
    <div class="modal-overlay" id="forgot-password-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Reset Password</h3>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            
            <div class="form-group">
                <label for="reset-email"><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" id="reset-email" placeholder="Enter your registered email">
                <div class="error-message" id="reset-email-error"></div>
            </div>
            <div id="reset-message" class="message"></div>
            <button class="btn btn-primary" id="send-reset-btn">Send Reset Link</button>
        </div>
    </div>
    
    <div id="spinner" class="spinner-overlay" style="display: none;"><div class="spinner"></div></div>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDCmvA9sFCSc5r4ZuFUJuGdO1LDoW7rKao",
            authDomain: "student-portal-free.firebaseapp.com",
            projectId: "student-portal-free",
            storageBucket: "student-portal-free.appspot.com",
            messagingSenderId: "272865877510",
            appId: "1:272865877510:web:0875a2502ae55bbf9ead87"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const authForm = document.getElementById('authForm'),
              messageArea = document.getElementById('message-area'),
              spinner = document.getElementById('spinner'),
              toggleLink = document.getElementById('toggle-link'),
              registrationFields = document.getElementById('registration-fields');
        let isLogin = true;
        let isSocialSignup = false;
        let socialUserData = null;

        // AUTH GUARD: Checks if user is already logged in and redirects them
        auth.onAuthStateChanged(user => {
            if (user) {
                spinner.style.display = 'flex';
                db.collection('users').doc(user.uid).get().then(doc => {
                    if (doc.exists) {
                        const path = doc.data().role === 'admin' ? '/admindashboard.html' : '/studentdashboard.html';
                        window.location.replace(path);
                    } else {
                        // User is in auth but not DB, log them out to be safe
                        auth.signOut();
                        spinner.style.display = 'none';
                    }
                });
            }
        });

        // Toggles between Login and Register views
        toggleLink.addEventListener('click', () => {
            isLogin = !isLogin; 
            authForm.reset(); 
            clearErrors();
            messageArea.textContent = '';
            document.getElementById('form-title').innerText = isLogin ? 'Login' : 'Register';
            document.getElementById('name-group').style.display = isLogin ? 'none' : 'block';
            document.getElementById('admission-group').style.display = isLogin ? 'none' : 'block';
            document.getElementById('registration-fields').style.display = isLogin ? 'none' : 'block';
            document.getElementById('submit-btn').innerText = isLogin ? 'Login' : 'Register';
            document.getElementById('toggle-text').innerText = isLogin ? "Don't have an account?" : 'Already have an account?';
            document.getElementById('toggle-link').innerText = isLogin ? 'Register Now' : 'Login';
            
            // Hide social signup fields when toggling
            isSocialSignup = false;
        });

        // Form validation
        function validateForm() {
            clearErrors();
            let isValid = true;
            
            // Email validation
            const email = document.getElementById('email').value.trim();
            if (!email) {
                showError('email', 'Email is required');
                isValid = false;
            } else if (!isValidEmail(email)) {
                showError('email', 'Please enter a valid email address');
                isValid = false;
            }
            
            // Password validation
            const password = document.getElementById('password').value;
            if (!password) {
                showError('password', 'Password is required');
                isValid = false;
            } else if (password.length < 6) {
                showError('password', 'Password must be at least 6 characters');
                isValid = false;
            }
            
            // Registration specific validation
            if (!isLogin) {
                const name = document.getElementById('name').value.trim();
                if (!name) {
                    showError('name', 'Full name is required');
                    isValid = false;
                }
                
                const admissionNo = document.getElementById('admissionNo').value.trim();
                if (!admissionNo) {
                    showError('admission', 'Admission number is required');
                    isValid = false;
                }
                
                const branch = document.getElementById('branch').value;
                if (!branch) {
                    showError('branch', 'Please select your branch');
                    isValid = false;
                }
                
                const semester = document.getElementById('semester').value;
                if (!semester) {
                    showError('semester', 'Please select your semester');
                    isValid = false;
                }
            }
            
            return isValid;
        }
        
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        function showError(field, message) {
            const errorElement = document.getElementById(`${field}-error`);
            errorElement.textContent = message;
            document.getElementById(field === 'admission' ? 'admissionNo' : field).parentElement.classList.add('error');
        }
        
        function clearErrors() {
            const errorElements = document.querySelectorAll('.error-message');
            errorElements.forEach(el => el.textContent = '');
            
            const formGroups = document.querySelectorAll('.form-group');
            formGroups.forEach(group => group.classList.remove('error'));
        }

        // Handles form submission for both Login and Register
        authForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!validateForm()) {
                return;
            }
            
            spinner.style.display = 'flex';
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;

            if (isLogin) {
                // Login with email and password
                auth.signInWithEmailAndPassword(email, password)
                    .then(userCredential => {
                        // The onAuthStateChanged listener above will handle redirection
                    })
                    .catch(handleAuthError);
            } else {
                const name = document.getElementById('name').value.trim();
                const admissionNo = document.getElementById('admissionNo').value.trim();
                const branch = document.getElementById('branch').value;
                const semester = document.getElementById('semester').value;
                
                // Create user with the actual email they provided
                auth.createUserWithEmailAndPassword(email, password)
                    .then(userCredential => {
                        // Store user data with the actual email
                        const userData = { 
                            name: name, 
                            admissionNo: admissionNo, 
                            email: email,
                            role: 'student',
                            branch: branch,
                            semester: semester,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        return db.collection('users').doc(userCredential.user.uid).set(userData);
                    })
                    .then(() => {
                        spinner.style.display = 'none';
                        messageArea.className = 'message success';
                        messageArea.textContent = 'Registration successful! Please login.';
                        toggleLink.click();
                    }).catch(handleAuthError);
            }
        });

        function handleAuthError(error) {
            console.error("Auth Error:", error);
            messageArea.textContent = error.message;
            messageArea.className = 'message error';
            spinner.style.display = 'none';
        }
        
        // Forgot Password Implementation
        const forgotPasswordLink = document.getElementById('forgot-password-link');
        const forgotPasswordModal = document.getElementById('forgot-password-modal');
        const modalClose = document.getElementById('modal-close');
        const sendResetBtn = document.getElementById('send-reset-btn');
        const resetMessage = document.getElementById('reset-message');
        const resetEmail = document.getElementById('reset-email');
        const resetEmailError = document.getElementById('reset-email-error');
        
        // Open modal when Forgot Password is clicked
        forgotPasswordLink.addEventListener('click', () => {
            forgotPasswordModal.classList.add('active');
            resetMessage.textContent = '';
            resetEmail.value = '';
            resetEmailError.textContent = '';
        });
        
        // Close modal
        modalClose.addEventListener('click', () => {
            forgotPasswordModal.classList.remove('active');
        });
        
        // Send password reset email
        sendResetBtn.addEventListener('click', () => {
            const email = resetEmail.value.trim();
            
            if (!email) {
                resetEmailError.textContent = 'Please enter your email address';
                return;
            }
            
            if (!isValidEmail(email)) {
                resetEmailError.textContent = 'Please enter a valid email address';
                return;
            }
            
            spinner.style.display = 'flex';
            
            // First check if the email exists in the database
            db.collection('users')
                .where('email', '==', email)
                .get()
                .then((querySnapshot) => {
                    if (querySnapshot.empty) {
                        spinner.style.display = 'none';
                        resetMessage.textContent = 'No account found with this email address';
                        resetMessage.className = 'message error';
                        return;
                    }
                    
                    // Use Firebase's built-in password reset with the email
                    auth.sendPasswordResetEmail(email)
                        .then(() => {
                            spinner.style.display = 'none';
                            resetMessage.textContent = 'Password reset email sent! Check your inbox.';
                            resetMessage.className = 'message success';
                            
                            // Close modal after 3 seconds
                            setTimeout(() => {
                                forgotPasswordModal.classList.remove('active');
                            }, 3000);
                        })
                        .catch(error => {
                            spinner.style.display = 'none';
                            resetMessage.textContent = error.message;
                            resetMessage.className = 'message error';
                        });
                })
                .catch((error) => {
                    spinner.style.display = 'none';
                    resetMessage.textContent = 'Error finding account: ' + error.message;
                    resetMessage.className = 'message error';
                });
        });
        
        // Google Sign-In
        document.getElementById('google-login').addEventListener('click', () => {
            spinner.style.display = 'flex';
            
            // For demo purposes, we'll simulate Google sign-in
            // In a real implementation, you would use:
            // const provider = new firebase.auth.GoogleAuthProvider();
            // auth.signInWithPopup(provider)
            
            setTimeout(() => {
                spinner.style.display = 'none';
                simulateSocialLogin('Google');
            }, 1000);
        });
        
        // Microsoft Sign-In
        document.getElementById('microsoft-login').addEventListener('click', () => {
            spinner.style.display = 'flex';
            
            // For demo purposes, we'll simulate Microsoft sign-in
            // In a real implementation, you would use:
            // const provider = new firebase.auth.OAuthProvider('microsoft.com');
            // auth.signInWithPopup(provider)
            
            setTimeout(() => {
                spinner.style.display = 'none';
                simulateSocialLogin('Microsoft');
            }, 1000);
        });
        
        // Function to simulate social login (for demo purposes)
        function simulateSocialLogin(provider) {
            isSocialSignup = true;
            socialUserData = {
                name: "Social User",
                email: `user${Math.floor(Math.random() * 10000)}@example.com`,
                provider: provider
            };
            
            // Change form to registration mode if not already
            if (isLogin) {
                toggleLink.click();
            }
            
            // Pre-fill email field
            document.getElementById('email').value = socialUserData.email;
            document.getElementById('email').disabled = true;
            
            messageArea.className = 'message success';
            messageArea.textContent = `Please complete your registration with ${provider}`;
        }
        
        // Handle social registration completion
        document.getElementById('submit-btn').addEventListener('click', function(e) {
            if (isSocialSignup) {
                e.preventDefault();
                
                if (!validateForm()) {
                    return;
                }
                
                const admissionNo = document.getElementById('admissionNo').value.trim();
                const name = document.getElementById('name').value.trim();
                const email = document.getElementById('email').value;
                const branch = document.getElementById('branch').value;
                const semester = document.getElementById('semester').value;
                
                spinner.style.display = 'flex';
                
                // In a real implementation, you would create the user in Firebase Auth
                // and then add to Firestore
                
                setTimeout(() => {
                    spinner.style.display = 'none';
                    messageArea.className = 'message success';
                    messageArea.textContent = 'Social registration successful!';
                    
                    // Reset form
                    isSocialSignup = false;
                    document.getElementById('email').disabled = false;
                    
                    // Simulate successful login
                    setTimeout(() => {
                        window.location.href = '/studentdashboard.html';
                    }, 1500);
                }, 1500);
            }
        });
    </script>
</body>
</html>

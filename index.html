<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="IB STUDIOZ - Online Learning Platform Login">
    <meta name="keywords" content="education, learning, materials, courses, login">
    <meta name="author" content="IB STUDIOZ">
    <meta name="theme-color" content="#FFD700">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>Welcome | IB STUDIOZ</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { 
            --primary: #FFC300; 
            --dark: #121212; 
            --text-primary: #ffffff; 
            --text-secondary: rgba(255, 255, 255, 0.7); 
            --card-bg: rgba(20, 20, 20, 0.7); 
            --border-color: rgba(255, 195, 0, 0.3); 
            --shadow-color: rgba(0, 0, 0, 0.4); 
            --success: #00b09b; 
            --danger: #ff416c; 
            --google: #DB4437;
            --microsoft: #0078D7;
            --info: #3498db;
            --github: #333;
            --facebook: #4267B2;
            --twitter: #1DA1F2;
            
            /* Branch colors */
            --cse-color: #3498db;
            --it-color: #9b59b6;
            --ece-color: #e74c3c;
            --eee-color: #f39c12;
            --mech-color: #2ecc71;
            --civil-color: #16a085;
            --bme-color: #e91e63;
            --ft-color: #ff5722;
            --mct-color: #00bcd4;
            --csd-color: #ff9800;
            --ads-color: #673ab7;
            --efe-color: #795548;
            --exe-color: #607d8b;
            
            /* Role colors */
            --student-color: #3498db;
            --faculty-color: #9b59b6;
            --admin-color: #e74c3c;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        /* Dark mode styles */
        body.dark-mode {
            --dark: #f5f5f5;
            --text-primary: #121212;
            --text-secondary: rgba(0, 0, 0, 0.7);
            --card-bg: rgba(255, 255, 255, 0.9);
            --border-color: rgba(255, 195, 0, 0.5);
        }
        
        body.dark-mode .auth-card {
            background: var(--card-bg);
            color: var(--text-primary);
        }
        
        body.dark-mode input, 
        body.dark-mode select {
            background-color: rgba(0, 0, 0, 0.1);
            color: var(--text-primary);
        }
        
        body.dark-mode .btn-secondary {
            background: rgba(0, 0, 0, 0.1);
            color: var(--text-primary);
        }
        
        body.dark-mode .social-login-options {
            background: rgba(0, 0, 0, 0.05);
        }
        
        body.dark-mode .branch-modal {
            background: var(--card-bg);
        }
        
        body.dark-mode .branch-item {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        body.dark-mode .semester-item {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        body.dark-mode .language-selector {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }
        
        body.dark-mode .language-option {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }
        
        /* --- KEYFRAME ANIMATIONS --- */
        @keyframes background-pan { 
            0% { background-position: 0% 50%; } 
            50% { background-position: 100% 50%; } 
            100% { background-position: 0% 50%; } 
        }
        @keyframes spin { 
            to { transform: rotate(360deg); } 
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes aurora-shimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        body { 
            font-family: "Poppins", sans-serif; 
            background-color: var(--dark); 
            color: var(--text-primary); 
            min-height: 100vh; 
            line-height: 1.6; 
            background-attachment: fixed;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* --- AURORA BACKGROUND ENHANCED --- */
        .aurora-background { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; 
            background: radial-gradient(ellipse at 10% 10%, var(--primary) 0%, rgba(255, 195, 0, 0) 40%), 
                        radial-gradient(ellipse at 90% 85%, #444 0%, rgba(68, 68, 68, 0) 35%),
                        radial-gradient(ellipse at 50% 50%, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 70%);
            animation: background-pan 45s linear infinite; 
            opacity: 0.3; 
        }
        
        .container { max-width: 1200px; margin: 30px auto; padding: 30px; }
        
        /* --- IB LOGO ENHANCED --- */
        .brand-logo { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            text-decoration: none; 
            color: var(--text-primary);
            transition: transform 0.3s ease;
        }
        .brand-logo:hover {
            transform: scale(1.03);
        }
        .brand-logo img { width: 50px; height: auto; }
        .brand-logo h1 { font-size: 1.5rem; font-weight: 600; margin: 0; }
        
        /* --- BRANDING STYLING --- */
        .brand-title-animated {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(120deg, #ff00c1, #00ffff, #33ff00, #ffc400, #ff00c1);
            background-size: 400% 400%;
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            animation: aurora-shimmer 8s ease-in-out infinite;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }
        
        .btn { 
            display: inline-flex; 
            align-items: center; 
            justify-content: center; 
            padding: 12px 30px; 
            border-radius: 10px; 
            border: none; 
            font-size: 1rem; 
            font-weight: 500; 
            cursor: pointer; 
            text-align: center; 
            transition: all 0.3s ease; 
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary { 
            background: var(--primary); 
            color: var(--dark); 
            box-shadow: 0 4px 15px rgba(255, 195, 0, 0.3); 
        }
        .btn-primary:hover { 
            transform: translateY(-3px) scale(1.02); 
            box-shadow: 0 6px 20px rgba(255, 195, 0, 0.5); 
        }
        .btn-secondary { 
            background: transparent; 
            color: var(--text-primary); 
            border: 1px solid var(--border-color); 
        }
        .btn-secondary:hover { 
            background: rgba(255, 255, 255, 0.1); 
            transform: translateY(-2px);
        }
        .btn-info {
            background: var(--info);
            color: white;
        }
        .btn-small { padding: 8px 15px; font-size: 0.9rem; }
        
        /* Role-specific buttons */
        .btn-student {
            background: var(--student-color);
            color: white;
        }
        .btn-faculty {
            background: var(--faculty-color);
            color: white;
        }
        .btn-admin {
            background: var(--admin-color);
            color: white;
        }
        
        /* Enhanced Dark mode toggle */
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 50px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .dark-mode-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            border-color: var(--primary);
        }
        
        .dark-mode-toggle i {
            font-size: 1.5rem;
            color: var(--primary);
            transition: all 0.3s ease;
        }
        
        /* Language selector */
        .language-selector {
            position: fixed;
            top: 90px;
            right: 20px;
            z-index: 1000;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        .language-selector:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }
        
        .language-options {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 10px;
            display: none;
            min-width: 150px;
            box-shadow: 0 8px 32px 0 var(--shadow-color);
        }
        
        .language-selector.active .language-options {
            display: block;
        }
        
        .language-option {
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .language-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .language-option.active {
            background: rgba(255, 195, 0, 0.2);
            color: var(--primary);
        }
        
        /* Social login buttons */
        .btn-google { background: var(--google); color: white; }
        .btn-microsoft { background: var(--microsoft); color: white; }
        .btn-github { background: var(--github); color: white; }
        .btn-facebook { background: var(--facebook); color: white; }
        .btn-twitter { background: var(--twitter); color: white; }
        .btn-social { margin: 8px 0; width: 100%; }
        .btn-social i { margin-right: 10px; }
        
        .auth-container { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 90vh;
            animation: fadeInUp 0.8s ease-out;
        }
        
        .auth-card { 
            width: 100%; 
            max-width: 450px; 
            text-align: center; 
            background: var(--card-bg); 
            backdrop-filter: blur(20px);
            border-radius: 15px; 
            border: 1px solid var(--border-color); 
            padding: 40px; 
            box-shadow: 0 8px 32px 0 var(--shadow-color);
            transition: all 0.5s ease;
        }
        
        .auth-card:hover {
            box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.5);
            transform: translateY(-5px);
        }
        
        .auth-card .brand-logo { justify-content: center; margin-bottom: 5px; }
        .auth-subtitle { color: var(--text-secondary); margin-bottom: 30px; font-size: 1rem; }
        
        #authForm h2 { 
            margin-bottom: 25px; 
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .form-group { 
            margin-bottom: 20px;
            opacity: 0;
            animation: fadeInUp 0.5s ease forwards;
            position: relative;
        }
        
        .form-group:nth-child(1) { animation-delay: 0.1s; }
        .form-group:nth-child(2) { animation-delay: 0.2s; }
        .form-group:nth-child(3) { animation-delay: 0.3s; }
        .form-group:nth-child(4) { animation-delay: 0.4s; }
        .form-group:nth-child(5) { animation-delay: 0.5s; }
        
        .form-group label { 
            text-align: left; 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 500; 
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }
        
        .form-group:hover label {
            color: var(--primary);
        }
        
        input, select { 
            width: 100%; 
            padding: 12px 15px; 
            border-radius: 8px; 
            border: 1px solid var(--border-color); 
            background-color: rgba(0, 0, 0, 0.3); 
            color: var(--text-primary); 
            font-size: 1rem; 
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus { 
            outline: none; 
            box-shadow: 0 0 0 3px rgba(255, 195, 0, 0.3); 
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        /* Password field with toggle */
        .password-container {
            position: relative;
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: color 0.3s ease;
        }
        
        .password-toggle:hover {
            color: var(--primary);
        }
        
        .auth-card .btn { width: 100%; margin-top: 10px; }
        .toggle-auth { margin-top: 25px; color: var(--text-secondary); }
        .toggle-auth a { color: var(--primary); font-weight: 600; text-decoration: none; cursor: pointer; }
        .message { min-height: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9rem; }
        .message.error { color: var(--danger); } 
        .message.success { color: var(--success); }
        .message.info { color: var(--info); }
        
        /* Password strength indicator */
        .password-strength {
            margin-top: 10px;
            display: none;
        }
        
        .strength-bar {
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .strength-fill {
            height: 100%;
            width: 0;
            transition: width 0.3s ease, background-color 0.3s ease;
        }
        
        .strength-weak { background: #ff416c; width: 25%; }
        .strength-medium { background: #ffc107; width: 50%; }
        .strength-strong { background: #00b09b; width: 75%; }
        .strength-very-strong { background: #28a745; width: 100%; }
        
        .strength-text {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .spinner-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; }
        .spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: var(--primary); animation: spin 1s ease-in-out infinite; }
        
        /* Button loading state */
        .btn-loading {
            position: relative;
            pointer-events: none;
            opacity: 0.7;
        }
        
        .btn-loading .btn-text {
            visibility: hidden;
        }
        
        .btn-loading .btn-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: block;
        }
        
        .btn-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }
        
        /* Divider */
        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }
        .divider::before, .divider::after {
            content: "";
            flex: 1;
            border-bottom: 1px solid var(--border-color);
        }
        .divider span {
            padding: 0 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Forgot Password Link */
        .forgot-password { 
            text-align: right; 
            margin-top: -10px; 
            margin-bottom: 20px; 
        }
        .forgot-password a { 
            color: var(--primary); 
            font-size: 0.9rem; 
            text-decoration: none; 
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .forgot-password a:hover { 
            text-decoration: underline;
            transform: translateX(3px);
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            width: 90%;
            max-width: 450px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 var(--shadow-color);
            transform: translateY(-50px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .modal-close:hover {
            transform: rotate(90deg);
        }
        
        /* Role selection modal */
        .role-selection-modal .modal {
            max-width: 550px;
        }
        
        .role-selection-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }
        
        .role-selection-subtitle {
            color: var(--text-secondary);
            margin-bottom: 25px;
        }
        
        .role-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .role-option {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .role-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .role-option.selected {
            border-color: var(--primary);
            background: rgba(255, 195, 0, 0.1);
        }
        
        .role-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
            color: white;
        }
        
        .role-icon.student {
            background: var(--student-color);
        }
        
        .role-icon.faculty {
            background: var(--faculty-color);
        }
        
        .role-details h3 {
            margin: 0 0 5px;
            font-size: 1.2rem;
            color: var(--text-primary);
        }
        
        .role-details p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .role-modal-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-left: 4px solid var(--success);
        }
        
        .toast.error {
            border-left: 4px solid var(--danger);
        }
        
        .toast.info {
            border-left: 4px solid var(--info);
        }
        
        .toast i {
            font-size: 1.2rem;
        }
        
        .toast.success i {
            color: var(--success);
        }
        
        .toast.error i {
            color: var(--danger);
        }
        
        .toast.info i {
            color: var(--info);
        }
        
        /* --- RESPONSIVE DESIGN --- */
        @media (max-width: 480px) {
            .auth-card { 
                padding: 25px; 
                margin: 0 15px;
            }
            .brand-logo img { width: 40px; }
            .brand-title-animated { font-size: 1.5rem; }
            .container { padding: 15px; margin: 15px auto; }
            .modal { padding: 20px; }
            .dark-mode-toggle {
                width: 50px;
                height: 50px;
            }
            .language-selector {
                width: 40px;
                height: 40px;
                padding: 8px;
            }
            .language-selector span {
                display: none;
            }
            .btn {
                padding: 12px 20px;
            }
        }
        
        .email-display {
            background: rgba(255, 195, 0, 0.1);
            border: 1px solid var(--primary);
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        
        .email-display i {
            color: var(--primary);
            margin-right: 8px;
        }
        
        /* Additional fields for social signup */
        .social-signup-fields {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        /* Form validation styles */
        .form-group.error input, 
        .form-group.error select {
            border-color: var(--danger);
            animation: shake 0.5s ease;
        }
        
        .error-message {
            color: var(--danger);
            font-size: 0.8rem;
            margin-top: 5px;
            text-align: left;
            display: none;
        }
        .form-group.error .error-message {
            display: block;
        }
        
        /* Page transition effect */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            z-index: 9999;
            transform: translateY(-100%);
            transition: transform 0.5s ease;
        }
        
        .page-transition.active {
            transform: translateY(0);
        }
        
        /* Loading skeleton */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Social registration modal */
        .social-registration-modal .modal {
            max-width: 500px;
        }
        
        .social-user-info {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .social-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }
        
        .social-details h3 {
            margin-bottom: 5px;
            color: var(--text-primary);
        }
        
        .social-details p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 480px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        /* Branch and Semester Modal */
        .branch-modal {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            width: 90%;
            max-width: 800px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 var(--shadow-color);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .branch-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .branch-modal-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .branch-modal-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .branch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .branch-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .branch-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .branch-item.selected {
            background: rgba(255, 195, 0, 0.2);
            border-color: var(--primary);
        }
        
        .branch-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .branch-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .branch-short {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .semester-container {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            display: none;
        }
        
        .semester-container.active {
            display: block;
        }
        
        .semester-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }
        
        .semester-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }
        
        .semester-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .semester-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }
        
        .semester-item.selected {
            background: rgba(255, 195, 0, 0.2);
            border-color: var(--primary);
        }
        
        .semester-number {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .semester-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .branch-modal-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }
        
        .branch-modal-actions .btn {
            min-width: 120px;
        }
        
        /* Course info */
        .course-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            display: none;
        }
        
        .course-info.active {
            display: block;
        }
        
        .course-info-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .course-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .course-item {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }
        
        .course-item:last-child {
            border-bottom: none;
        }
        
        .course-code {
            color: var(--primary);
            font-weight: 500;
        }
        
        .course-name {
            color: var(--text-secondary);
            margin-left: 10px;
        }
        
        .course-credits {
            float: right;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }
        
        /* Terms and privacy */
        .terms-privacy {
            margin-top: 20px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .terms-privacy a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .terms-privacy a:hover {
            text-decoration: underline;
        }
        
        /* Help section */
        .help-section {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .help-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .help-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--card-bg);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Accessibility features */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Skip to content link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: var(--dark);
            padding: 8px;
            text-decoration: none;
            border-radius: 0 0 4px 0;
            z-index: 100;
        }
        
        .skip-link:focus {
            top: 0;
        }
        
        /* Focus styles for better accessibility */
        a:focus, button:focus, input:focus, select:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
        
        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Print styles */
        @media print {
            .aurora-background, .dark-mode-toggle, .language-selector, .help-section {
                display: none;
            }
            
            body {
                background: white;
                color: black;
            }
            
            .auth-card {
                border: 1px solid #ddd;
                box-shadow: none;
            }
        }
        
        /* Floating action buttons */
        .floating-actions {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: flex-end;
        }
        
        .floating-btn {
            background: linear-gradient(135deg, var(--primary), var(--info));
            color: var(--text-inverse);
            border: none;
            border-radius: 50px;
            padding: 15px 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            text-decoration: none;
            position: relative;
            overflow: hidden;
            animation: float 3s ease-in-out infinite;
        }
        
        .floating-btn.help {
            animation-delay: 1s;
        }
        
        @keyframes float {
            0%, 100% { 
                transform: translateY(0px); 
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            }
            50% { 
                transform: translateY(-10px); 
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 0 20px rgba(255, 215, 0, 0.3);
            }
        }
        
        .floating-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 30px rgba(255, 215, 0, 0.5);
        }
        
        .floating-btn:active {
            transform: translateY(-2px) scale(1.02);
        }
        
        .floating-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50px;
            background: inherit;
            z-index: -1;
            animation: pulse 2s ease-out infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.3);
                opacity: 0;
            }
        }
        
        .btn-text {
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        /* Hide text on mobile */
        @media (max-width: 768px) {
            .btn-text {
                display: none;
            }
            
            .floating-btn {
                padding: 12px 16px;
                font-size: 0.9rem;
                width: 50px;
                height: 50px;
                justify-content: center;
            }
            
            .floating-btn:hover .btn-text {
                display: inline-block;
                position: absolute;
                right: 100%;
                margin-right: 10px;
                background: var(--card-bg);
                padding: 5px 10px;
                border-radius: 20px;
                white-space: nowrap;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="aurora-background"></div>
    
    <!-- Enhanced Dark mode toggle -->
    <button class="dark-mode-toggle tooltip" id="dark-mode-toggle" title="Toggle dark mode" aria-label="Toggle dark mode">
        <i class="fas fa-moon"></i>
    </button>
    
    <!-- Language selector -->
    <div class="language-selector" id="language-selector">
        <i class="fas fa-globe"></i>
        <span id="current-language">English</span>
        <div class="language-options">
            <div class="language-option active" data-lang="en">
                <i class="fas fa-flag-usa"></i>
                <span>English</span>
            </div>
            <div class="language-option" data-lang="es">
                <i class="fas fa-flag"></i>
                <span>Spanish</span>
            </div>
            <div class="language-option" data-lang="fr">
                <i class="fas fa-flag"></i>
                <span>French</span>
            </div>
            <div class="language-option" data-lang="de">
                <i class="fas fa-flag"></i>
                <span>German</span>
            </div>
            <div class="language-option" data-lang="zh">
                <i class="fas fa-flag"></i>
                <span>Chinese</span>
            </div>
            <div class="language-option" data-lang="ja">
                <i class="fas fa-flag"></i>
                <span>Japanese</span>
            </div>
        </div>
    </div>
    
    <div class="container auth-container" id="main-content">
        <div class="auth-card">
            <div class="brand-logo">
                <!-- Enhanced IB STUDIOZ logo -->
                <svg width="50" height="50" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#FFD700" />
                            <stop offset="100%" stop-color="#FFA500" />
                        </linearGradient>
                        <filter id="glow">
                            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                    </defs>
                    <circle cx="50" cy="50" r="45" fill="url(#goldGradient)" filter="url(#glow)" />
                    <!-- Redesigned IB letters -->
                    <g fill="#121212" filter="url(#glow)">
                        <!-- Letter I -->
                        <rect x="30" y="25" width="12" height="50" rx="2" />
                        <!-- Letter B -->
                        <path d="M50,25 L50,75 L65,75 C75,75 80,70 80,62 C80,55 75,50 68,50 C75,50 80,45 80,38 C80,30 75,25 65,25 Z M55,35 L65,35 C68,35 70,37 70,40 C70,43 68,45 65,45 L55,45 Z M55,55 L65,55 C68,55 70,57 70,60 C70,63 68,65 65,65 L55,65 Z" />
                    </g>
                </svg>
                <h1 class="brand-title-animated">IB STUDIOZ</h1>
            </div>
            <p class="auth-subtitle">Online Resources Hub</p>
            
            <form id="authForm" novalidate>
                <h2 id="form-title">Login</h2>
                <div class="form-group" id="name-group" style="display: none;">
                    <label for="name"><i class="fas fa-user"></i> Full Name</label>
                    <input type="text" id="name" placeholder="Enter your full name" aria-required="true">
                    <div class="error-message" id="name-error"></div>
                </div>
                <div class="form-group">
                    <label for="email"><i class="fas fa-envelope"></i> Email Address</label>
                    <input type="email" id="email" placeholder="Enter your email address" required aria-required="true">
                    <div class="error-message" id="email-error"></div>
                </div>
                <div class="form-group" id="admission-group" style="display: none;">
                    <label for="admissionNo"><i class="fas fa-id-card"></i> Admission No</label>
                    <input type="text" id="admissionNo" placeholder="e.g., 717821F123" aria-required="true">
                    <div class="error-message" id="admission-error"></div>
                </div>
                <div class="form-group">
                    <label for="password"><i class="fas fa-lock"></i> Password</label>
                    <div class="password-container">
                        <input type="password" id="password" placeholder="Minimum 6 characters" required aria-required="true">
                        <button type="button" class="password-toggle" id="password-toggle" aria-label="Toggle password visibility">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="error-message" id="password-error"></div>
                    <div class="password-strength" id="password-strength">
                        <div class="strength-bar">
                            <div class="strength-fill" id="strength-fill"></div>
                        </div>
                        <div class="strength-text" id="strength-text">Password strength</div>
                    </div>
                </div>
                
                <!-- Additional fields for registration -->
                <div id="registration-fields" style="display: none;">
                    <div class="form-group">
                        <label for="branch"><i class="fas fa-graduation-cap"></i> Branch</label>
                        <select id="branch" aria-required="true">
                            <option value="">Select branch</option>
                            <option value="CSE">Computer Science</option>
                            <option value="IT">Information Technology</option>
                            <option value="ECE">Electronics</option>
                            <option value="EEE">Electrical</option>
                            <option value="MECH">Mechanical</option>
                            <option value="CIVIL">Civil</option>
                            <option value="BME">Biomedical</option>
                            <option value="FT">Fashion Technology</option>
                            <option value="MCT">Mechatronics</option>
                            <option value="CSD">CS & Design</option>
                            <option value="ADS">AI & Data Science</option>
                            <option value="EFE">Electrical & Computer</option>
                            <option value="EXE">Electronics & Computer</option>
                            <option value="AIML">AI & Machine Learning</option>
                        </select>
                        <div class="error-message" id="branch-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="semester"><i class="fas fa-calendar-alt"></i> Semester</label>
                        <select id="semester" aria-required="true">
                            <option value="">Select semester</option>
                            <option value="1">Semester 1</option>
                            <option value="2">Semester 2</option>
                            <option value="3">Semester 3</option>
                            <option value="4">Semester 4</option>
                            <option value="5">Semester 5</option>
                            <option value="6">Semester 6</option>
                            <option value="7">Semester 7</option>
                            <option value="8">Semester 8</option>
                        </select>
                        <div class="error-message" id="semester-error"></div>
                    </div>
                </div>
                
                <div class="forgot-password">
                    <a id="forgot-password-link">Forgot Password?</a>
                </div>
                <div id="message-area" class="message" role="alert" aria-live="polite"></div>
                <button type="submit" class="btn btn-primary" id="submit-btn">
                    <span class="btn-text">Login</span>
                    <div class="btn-spinner"></div>
                </button>
                
                <div class="divider">
                    <span>OR</span>
                </div>
                
                <div class="social-login-options">
                    <div class="social-login-title">Continue with</div>
                    <div class="social-buttons">
                        <button type="button" class="btn btn-social btn-google" id="google-login" aria-label="Continue with Google">
                            <i class="fab fa-google"></i>
                        </button>
                        <button type="button" class="btn btn-social btn-microsoft" id="microsoft-login" aria-label="Continue with Microsoft">
                            <i class="fab fa-microsoft"></i>
                        </button>
                        <button type="button" class="btn btn-social btn-github" id="github-login" aria-label="Continue with GitHub">
                            <i class="fab fa-github"></i>
                        </button>
                        <button type="button" class="btn btn-social btn-facebook" id="facebook-login" aria-label="Continue with Facebook">
                            <i class="fab fa-facebook"></i>
                        </button>
                    </div>
                </div>
            </form>
            <p class="toggle-auth"><span id="toggle-text">Don't have an account?</span> <a id="toggle-link">Register Now</a></p>
            
            <div class="terms-privacy">
                By continuing, you agree to our <a href="#" id="terms-link">Terms of Service</a> and <a href="#" id="privacy-link">Privacy Policy</a>
            </div>
        </div>
    </div>
    
    <!-- Floating action buttons -->
    <div class="floating-actions">
        <button class="floating-btn help" id="chatbot-btn">
            <i class="fas fa-comments"></i>
            <span class="btn-text">IB HELP</span>
        </button>
    </div>
    
    <!-- Forgot Password Modal -->
    <div class="modal-overlay" id="forgot-password-modal" role="dialog" aria-labelledby="forgot-password-title">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="forgot-password-title">Reset Password</h3>
                <button class="modal-close" id="modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <div class="form-group">
                <label for="reset-email"><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" id="reset-email" placeholder="Enter your registered email" aria-required="true">
                <div class="error-message" id="reset-email-error"></div>
            </div>
            <div id="reset-message" class="message" role="alert" aria-live="polite"></div>
            <button class="btn btn-primary" id="send-reset-btn">
                <span class="btn-text">Send Reset Link</span>
                <div class="btn-spinner"></div>
            </button>
        </div>
    </div>
    
    <!-- Role Selection Modal -->
    <div class="modal-overlay role-selection-modal" id="role-selection-modal" role="dialog" aria-labelledby="role-selection-title">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="role-selection-title">Select Your Role</h3>
                <button class="modal-close" id="role-modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <p class="role-selection-subtitle">Please select your role to continue to the appropriate dashboard</p>
            
            <div class="role-options">
                <div class="role-option" data-role="student">
                    <div class="role-icon student">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div class="role-details">
                        <h3>Student</h3>
                        <p>Access learning materials, quizzes, and seminars</p>
                    </div>
                </div>
                
                <div class="role-option" data-role="faculty">
                    <div class="role-icon faculty">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <div class="role-details">
                        <h3>Faculty</h3>
                        <p>Manage courses, materials, and student progress</p>
                    </div>
                </div>
            </div>
            
            <div class="role-modal-actions">
                <button class="btn btn-secondary" id="role-modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="role-modal-confirm">Continue</button>
            </div>
        </div>
    </div>
    
    <!-- Social Registration Modal -->
    <div class="modal-overlay social-registration-modal" id="social-registration-modal" role="dialog" aria-labelledby="social-registration-title">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="social-registration-title">Complete Your Registration</h3>
                <button class="modal-close" id="social-modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <div class="social-user-info">
                <img src="" alt="Profile" class="social-avatar" id="social-avatar">
                <div class="social-details">
                    <h3 id="social-name"></h3>
                    <p id="social-email"></p>
                </div>
            </div>
            
            <form id="social-registration-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="social-admission"><i class="fas fa-id-card"></i> Admission No</label>
                        <input type="text" id="social-admission" placeholder="e.g., 717821F123" required aria-required="true">
                        <div class="error-message" id="social-admission-error"></div>
                    </div>
                    <div class="form-group">
                        <label for="social-branch"><i class="fas fa-graduation-cap"></i> Branch</label>
                        <select id="social-branch" required aria-required="true">
                            <option value="">Select branch</option>
                            <option value="CSE">Computer Science</option>
                            <option value="IT">Information Technology</option>
                            <option value="ECE">Electronics</option>
                            <option value="EEE">Electrical</option>
                            <option value="MECH">Mechanical</option>
                            <option value="CIVIL">Civil</option>
                            <option value="BME">Biomedical</option>
                            <option value="FT">Fashion Technology</option>
                            <option value="MCT">Mechatronics</option>
                            <option value="CSD">CS & Design</option>
                            <option value="ADS">AI & Data Science</option>
                            <option value="EFE">Electrical & Computer</option>
                            <option value="EXE">Electronics & Computer</option>
                            <option value="AIML">AI & Machine Learning</option>
                        </select>
                        <div class="error-message" id="social-branch-error"></div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="social-semester"><i class="fas fa-calendar-alt"></i> Semester</label>
                        <select id="social-semester" required aria-required="true">
                            <option value="">Select semester</option>
                            <option value="1">Semester 1</option>
                            <option value="2">Semester 2</option>
                            <option value="3">Semester 3</option>
                            <option value="4">Semester 4</option>
                            <option value="5">Semester 5</option>
                            <option value="6">Semester 6</option>
                            <option value="7">Semester 7</option>
                            <option value="8">Semester 8</option>
                        </select>
                        <div class="error-message" id="social-semester-error"></div>
                    </div>
                    <div class="form-group">
                        <label for="social-phone"><i class="fas fa-phone"></i> Phone Number</label>
                        <input type="tel" id="social-phone" placeholder="Enter your phone number">
                        <div class="error-message" id="social-phone-error"></div>
                    </div>
                </div>
                
                <div id="social-message" class="message" role="alert" aria-live="polite"></div>
                <button type="submit" class="btn btn-primary" id="social-submit-btn">
                    <span class="btn-text">Complete Registration</span>
                    <div class="btn-spinner"></div>
                </button>
            </form>
        </div>
    </div>
    
    <!-- Branch and Semester Selection Modal -->
    <div class="modal-overlay" id="branch-modal" role="dialog" aria-labelledby="branch-modal-title">
        <div class="branch-modal">
            <div class="branch-modal-header">
                <div>
                    <h3 class="branch-modal-title" id="branch-modal-title">Select Your Branch & Semester</h3>
                    <p class="branch-modal-subtitle">Choose your academic branch and semester to personalize your experience</p>
                </div>
                <button class="modal-close" id="branch-modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <div class="branch-grid" id="branch-grid">
                <!-- Branch items will be populated by JavaScript -->
            </div>
            
            <div class="semester-container" id="semester-container">
                <h4 class="semester-title">Select Semester</h4>
                <div class="semester-grid" id="semester-grid">
                    <!-- Semester items will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="course-info" id="course-info">
                <h4 class="course-info-title">Courses in Selected Semester</h4>
                <div class="course-list" id="course-list">
                    <!-- Course items will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="branch-modal-actions">
                <button class="btn btn-secondary" id="branch-modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="branch-modal-confirm">Confirm</button>
            </div>
        </div>
    </div>
    
    <!-- Terms Modal -->
    <div class="modal-overlay" id="terms-modal" role="dialog" aria-labelledby="terms-title">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="terms-title">Terms of Service</h3>
                <button class="modal-close" id="terms-modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <div class="modal-content">
                <h4>1. Acceptance of Terms</h4>
                <p>By accessing and using IB STUDIOZ, you accept and agree to be bound by the terms and provision of this agreement.</p>
                
                <h4>2. Use License</h4>
                <p>Permission is granted to temporarily download one copy of the materials on IB STUDIOZ for personal, non-commercial transitory viewing only.</p>
                
                <h4>3. Disclaimer</h4>
                <p>The materials on IB STUDIOZ are provided on an 'as is' basis. IB STUDIOZ makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights.</p>
                
                <h4>4. Limitations</h4>
                <p>In no event shall IB STUDIOZ or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on IB STUDIOZ.</p>
                
                <button class="btn btn-secondary" id="accept-terms-btn">I Accept</button>
            </div>
        </div>
    </div>
    
    <!-- Privacy Modal -->
    <div class="modal-overlay" id="privacy-modal" role="dialog" aria-labelledby="privacy-title">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="privacy-title">Privacy Policy</h3>
                <button class="modal-close" id="privacy-modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <div class="modal-content">
                <h4>Information Collection and Use</h4>
                <p>We collect several different types of information for various purposes to provide and improve our service to you.</p>
                
                <h4>Types of Data Collected</h4>
                <p><strong>Personal Data:</strong> While using our Service, we may ask you to provide us with certain personally identifiable information that can be used to contact or identify you.</p>
                
                <p><strong>Usage Data:</strong> We may also collect information on how the Service is accessed and used.</p>
                
                <h4>Use of Data</h4>
                <p>IB STUDIOZ uses the collected data for various purposes:</p>
                <ul>
                    <li>To provide and maintain the Service</li>
                    <li>To notify you about changes to our Service</li>
                    <li>To provide customer support</li>
                    <li>To monitor the usage of the Service</li>
                    <li>To detect, prevent and address technical issues</li>
                </ul>
                
                <button class="btn btn-secondary" id="accept-privacy-btn">I Accept</button>
            </div>
        </div>
    </div>
    
    <!-- Help Modal -->
    <div class="modal-overlay" id="help-modal" role="dialog" aria-labelledby="help-title">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="help-title">Help & Support</h3>
                <button class="modal-close" id="help-modal-close" aria-label="Close modal">&times;</button>
            </div>
            
            <div class="modal-content">
                <h4>Getting Started</h4>
                <p>If you're new to IB STUDIOZ, follow these steps to get started:</p>
                <ol>
                    <li>Create an account using your email address</li>
                    <li>Complete your profile with your academic details</li>
                    <li>Browse through the available study materials</li>
                    <li>Join study groups and participate in discussions</li>
                </ol>
                
                <h4>Frequently Asked Questions</h4>
                <p><strong>Q: How do I reset my password?</strong></p>
                <p>A: Click on the "Forgot Password?" link on the login page and follow the instructions.</p>
                
                <p><strong>Q: Can I change my email address?</strong></p>
                <p>A: Yes, you can update your email address from your profile settings after logging in.</p>
                
                <p><strong>Q: Is there a mobile app available?</strong></p>
                <p>A: Currently, IB STUDIOZ is available as a web application. We're working on a mobile app and will announce its release soon.</p>
                
                <h4>Contact Support</h4>
                <p>If you need further assistance, please contact our support team at support@ibstudioz.com.</p>
            </div>
        </div>
    </div>
    
    <div id="spinner" class="spinner-overlay" style="display: none;"><div class="spinner"></div></div>
    
    <!-- Page transition element -->
    <div class="page-transition" id="page-transition"></div>
    
    <!-- Toast container -->
    <div id="toast-container"></div>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDCmvA9sFCSc5r4ZuFUJuGdO1LDoW7rKao",
            authDomain: "student-portal-free.firebaseapp.com",
            projectId: "student-portal-free",
            storageBucket: "student-portal-free.appspot.com",
            messagingSenderId: "272865877510",
            appId: "1:272865877510:web:0875a2502ae55bbf9ead87"
        };
        
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Academic branches data
        const branches = {
            "CSE": {"name":"Computer Science","color":"var(--cse-color)","icon":"fas fa-laptop-code","semesters":{"1":[{"code":"U23ENG101A","name":"Communication Skills in English","credits":3},{"code":"U23MAT102A","name":"Linear Algebra and Calculus With MATLAB","credits":4},{"code":"U23PHY103B","name":"Engineering Physics","credits":3},{"code":"U23PPR105","name":"Problem Solving using Python Programming","credits":3},{"code":"U23BEE106A","name":"Basic Electrical and Electronics Engineering","credits":3},{"code":"U23TAM101","name":"Heritage of Tamils","credits":1},{"code":"U23PHL110","name":"Engineering Physics Lab","credits":1},{"code":"U23BEEL113","name":"Basic Electrical and Electronics Engineering Lab","credits":1},{"code":"U23PPL112","name":"Python Programming Lab","credits":1}],"2":[{"code":"U23ENG201A","name":"Technical English","credits":2},{"code":"U23MAT202B","name":"Discrete Mathematics","credits":4},{"code":"U23CHE204B","name":"Chemistry For Computer Science","credits":3},{"code":"U23CPR205B","name":"Programming In C","credits":3},{"code":"U23EGR207","name":"Engineering Graphics","credits":3},{"code":"U23EC203","name":"Digital Principles And System Design","credits":3},{"code":"U23CHL211","name":"Chemistry Lab","credits":1},{"code":"U23CPL212","name":"C programming Lab","credits":1},{"code":"U23TAM201","name":"Tamils And Technology","credits":1}],"3":[{"code":"U23MAT301D","name":"Probability and Statistics","credits":4},{"code":"U23CS301","name":"Data Structures","credits":3},{"code":"U23CS302","name":"Computer Architecture","credits":3},{"code":"U23CS303","name":"Object Oriented Programming","credits":3},{"code":"U23CS304","name":"Operating Systems","credits":3},{"code":"U23CS305","name":"Computer Information and Ethics","credits":3},{"code":"U23CS306","name":"Data Structures Lab","credits":1},{"code":"U23CS307","name":"Object Oriented Programming Lab","credits":1},{"code":"U23GE301","name":"Soft Skills and Aptitude-I","credits":1},{"code":"Noc24-mg72","name":"NPTEL:design Thinking-A Primer","credits":1}],"4":[{"code":"U23MAT401B","name":"Numerical Methods","credits":4},{"code":"U23CS401","name":"Design And Analysis of Algorithms","credits":3},{"code":"U23CS402","name":"Software Engineering","credits":3},{"code":"U23CS403","name":"DataBase Management Systems","credits":3},{"code":"U23CS404","name":"Embedded System Design ","credits":3},{"code":"U23CS405","name":"Software Development Lab","credits":1},{"code":"U23CS403","name":"Database Management Systems Lab","credits":1}],"5":[{"code":"U23CS504","name":"Machine Learning","credits":3},{"code":"U23CS501","name":"Computer Networks","credits":3},{"code":"U23CS502","name":"Artificial Intelligence","credits":3},{"code":"U23CS503","name":"Theory of Computation","credits":3},{"code":"noc25-cs135","name":"Elective NPTEL","credits":3},{"code":" U23CS947 / U23CS903","name":"Professional Elective ","credits":3},{"code":"U23CS505","name":"Computer Networks Laboratory","credits":2},{"code":"U23CS506","name":"Artificial Intelligence and Machine Learning Laboratory","credits":1},{"code":"U23GE501","name":"Soft Skills and Aptitude-III","credits":1}],"6":[],"7":[],"8":[]}},
            "IT": {"name":"Info. Technology","color":"var(--it-color)","icon":"fas fa-network-wired","semesters":{"1":[{"code":"U23IT101","name":"Programming Fundamentals","credits":4},{"code":"U23IT102","name":"Discrete Mathematics","credits":4},{"code":"U23IT103","name":"Digital Systems","credits":3},{"code":"U23IT104","name":"Computer Organization","credits":3},{"code":"U23IT105","name":"Communication Skills","credits":2},{"code":"U23IT106","name":"Programming Lab","credits":1},{"code":"U23IT107","name":"Digital Systems Lab","credits":1}],"2":[{"code":"U23IT201","name":"Data Structures","credits":4},{"code":"U23IT202","name":"Database Systems","credits":4},{"code":"U23IT203","name":"Operating Systems","credits":3},{"code":"U23IT204","name":"Computer Networks","credits":3},{"code":"U23IT205","name":"Web Technologies","credits":3},{"code":"U23IT206","name":"Data Structures Lab","credits":1},{"code":"U23IT207","name":"Web Technologies Lab","credits":1}],"3":[],"4":[],"5":[],"6":[],"7":[],"8":[]}},
            "ECE": {"name":"Electronics & Comm","color":"var(--ece-color)","icon":"fas fa-satellite-dish","semesters":{"1":[{"code":"U23EC101","name":"Basic Electronics","credits":4},{"code":"U23EC102","name":"Circuit Theory","credits":4},{"code":"U23EC103","name":"Engineering Mathematics","credits":4},{"code":"U23EC104","name":"Programming in C","credits":3},{"code":"U23EC105","name":"Communication Skills","credits":2},{"code":"U23EC106","name":"Electronics Lab","credits":1},{"code":"U23EC107","name":"Programming Lab","credits":1}],"2":[{"code":"U23EC201","name":"Analog Electronics","credits":4},{"code":"U23EC202","name":"Digital Electronics","credits":4},{"code":"U23EC203","name":"Signals and Systems","credits":4},{"code":"U23EC204","name":"Electromagnetic Theory","credits":3},{"code":"U23EC205","name":"Data Structures","credits":3},{"code":"U23EC206","name":"Analog Electronics Lab","credits":1},{"code":"U23EC207","name":"Digital Electronics Lab","credits":1}],"3":[],"4":[],"5":[],"6":[],"7":[],"8":[]}},
            "EEE": {"name":"Electrical & Electronics","color":"var(--eee-color)","icon":"fas fa-bolt","semesters":{"1":[{"code":"U23EE101","name":"Basic Electrical Engineering","credits":4},{"code":"U23EE102","name":"Engineering Mathematics","credits":4},{"code":"U23EE103","name":"Electronics Engineering","credits":3},{"code":"U23EE104","name":"Programming in C","credits":3},{"code":"U23EE105","name":"Communication Skills","credits":2},{"code":"U23EE106","name":"Electrical Lab","credits":1},{"code":"U23EE107","name":"Programming Lab","credits":1}],"2":[{"code":"U23EE201","name":"Circuit Theory","credits":4},{"code":"U23EE202","name":"Electromagnetic Theory","credits":4},{"code":"U23EE203","name":"Digital Electronics","credits":4},{"code":"U23EE204","name":"Electrical Machines","credits":3},{"code":"U23EE205","name":"Data Structures","credits":3},{"code":"U23EE206","name":"Circuit Theory Lab","credits":1},{"code":"U23EE207","name":"Digital Electronics Lab","credits":1}],"3":[],"4":[],"5":[],"6":[],"7":[],"8":[]}},
            "MECH": {"name":"Mechanical","color":"var(--mech-color)","icon":"fas fa-cogs","semesters":{"1":[{"code":"U23ME101","name":"Engineering Mechanics","credits":4},{"code":"U23ME102","name":"Engineering Graphics","credits":4},{"code":"U23ME103","name":"Engineering Mathematics","credits":4},{"code":"U23ME104","name":"Basic Electrical Engineering","credits":3},{"code":"U23ME105","name":"Communication Skills","credits":2},{"code":"U23ME106","name":"Workshop Practice","credits":1},{"code":"U23ME107","name":"Engineering Graphics Lab","credits":1}],"2":[{"code":"U23ME201","name":"Thermodynamics","credits":4},{"code":"U23ME202","name":"Mechanics of Materials","credits":4},{"code":"U23ME203","name":"Manufacturing Technology","credits":4},{"code":"U23ME204","name":"Fluid Mechanics","credits":3},{"code":"U23ME205","name":"Computer Programming","credits":3},{"code":"U23ME206","name":"Thermodynamics Lab","credits":1},{"code":"U23ME207","name":"Manufacturing Technology Lab","credits":1}],"3":[],"4":[],"5":[],"6":[],"7":[],"8":[]}},
            "AIML": {"name":"AI & Machine Learning","color":"var(--aiml-color)","icon":"fas fa-brain","semesters":{"1":[{"code":"U23EG107","name":"Engineering Graphics","credits":3},{"code":"U23ENG101A","name":"Communication Skills in English","credits":3},{"code":"U23MAT102A","name":"Linear Algebra and Calculus with MATLAB","credits":4},{"code":"U23PPR105","name":"Problem Solving using Python Programming","credits":3},{"code":"U23PHY103E","name":"Engineering Physics","credits":3},{"code":"U23PHL110","name":"Engineering Physics Laboratory","credits":1},{"code":"U23PPL112","name":"Python Programming Laboratory","credits":1},{"code":"U23TAM101","name":"Heritage of Tamils","credits":1}],"2":[{"code":"U23ENG201A","name":"Technical English","credits":2},{"code":"U23MAT202D","name":"Discrete Mathematics","credits":4},{"code":"U23BEEE206B","name":"Basics of Electrical and Electronics Engineering","credits":3},{"code":"U23CPR205","name":"Programming in C","credits":3},{"code":"U23CHE204C","name":"Applied Chemistry","credits":2},{"code":"U23EC203","name":"Digital Principles and System Design","credits":3},{"code":"U23CPL212","name":"C Programming Laboratory","credits":1},{"code":"U23CHL211","name":"Chemistry Laboratory","credits":1},{"code":"U23BEEL213B","name":"BEEE Laboratory","credits":1},{"code":"U23TAM201","name":"Tamils and Technology","credits":1}],"3":[{"code":"U23MAT301E","name":"Applied Probability and Statistics-I","credits":4},{"code":"U23CS301","name":"Data Structures","credits":3},{"code":"U23CS302","name":"Computer Architecture","credits":3},{"code":"U23CS303","name":"Object Oriented Programming Using Java","credits":3},{"code":"U23AML301","name":"Data Visualization","credits":3},{"code":"noc25-mg106","name":"NPTEL: Design Thinking - A Primer","credits":1},{"code":"U23CS306","name":"Data Structures Laboratory","credits":1},{"code":"U23CS307","name":"Object Oriented Programming Using Java Laboratory","credits":1},{"code":"U23AML302","name":"Data Visualization Laboratory","credits":1},{"code":"U23GE301","name":"Soft Skills and Aptitude-I","credits":1}],"4":[{"code":"U23MAT401A","name":"Applied Probability and Statistics-II","credits":4},{"code":"U23CS403","name":"Database Management Systems","credits":3},{"code":"U23CS401","name":"Design and Analysis of Algorithms","credits":3},{"code":"U23AML401","name":"Artificial Intelligence","credits":3},{"code":"U23CSD402","name":"Operating Systems","credits":3},{"code":"U23AML402","name":"Artificial Intelligence Lab","credits":1},{"code":"U23CS405","name":"Database Management Systems Lab","credits":1},{"code":"U23GE401","name":"Soft Skills and Aptitude-II","credits":1}],"5":[{"code":"U23CS504","name":"Machine Learning","credits":3},{"code":"U23CS501","name":"Computer Networks","credits":3},{"code":"U23CSD502","name":"Software Engineering","credits":3},{"code":"U23CS503","name":"Theory of Computation","credits":3},{"code":"noc25-cs135","name":"Elective NPTEL","credits":3},{"code":"U19CS903","name":"Professional Elective - Agile Methodologies","credits":3},{"code":"U23AML501","name":"Machine Learning Laboratory","credits":2},{"code":"U23CSD504","name":"Software Development Laboratory","credits":1},{"code":"U23GE501","name":"Soft Skills and Aptitude -III","credits":1}],"6":[{"code":"U23CS601","name":"Computer Vision","credits":3},{"code":"U23CS602","name":"Reinforcement Learning","credits":3},{"code":"U23CS603","name":"Robotics","credits":3},{"code":"U23CS604","name":"Cyber Security","credits":3},{"code":"U23CS605","name":"Blockchain Technology","credits":3},{"code":"U23CS606","name":"Elective III","credits":3},{"code":"U23CS607","name":"Project Work II","credits":3}],"7":[{"code":"U23CS701","name":"Advanced Machine Learning","credits":3},{"code":"U23CS702","name":"AI Ethics and Governance","credits":3},{"code":"U23CS703","name":"Elective IV","credits":3},{"code":"U23CS704","name":"Project Work III","credits":3}],"8":[{"code":"U23CS801","name":"Industry Internship","credits":6},{"code":"U23CS802","name":"Project Work IV","credits":6}]}},
            "CIVIL": {"name":"Civil Engineering","color":"var(--civil-color)","icon":"fas fa-building","semesters":{"1":[{"code":"U23CE101","name":"Engineering Mechanics","credits":4},{"code":"U23CE102","name":"Engineering Graphics","credits":4},{"code":"U23CE103","name":"Engineering Mathematics","credits":4},{"code":"U23CE104","name":"Basic Civil Engineering","credits":3},{"code":"U23CE105","name":"Communication Skills","credits":2},{"code":"U23CE106","name":"Surveying","credits":1},{"code":"U23CE107","name":"Engineering Graphics Lab","credits":1}],"2":[{"code":"U23CE201","name":"Building Materials","credits":4},{"code":"U23CE202","name":"Structural Analysis","credits":4},{"code":"U23CE203","name":"Fluid Mechanics","credits":4},{"code":"U23CE204","name":"Surveying","credits":3},{"code":"U23CE205","name":"Computer Programming","credits":3},{"code":"U23CE206","name":"Building Materials Lab","credits":1},{"code":"U23CE207","name":"Surveying Lab","credits":1}]}},
            "BME": {"name":"Bio Medical","color":"var(--bme-color)","icon":"fas fa-heartbeat","semesters":{"1":[{"code":"U23BM101","name":"Human Anatomy","credits":4},{"code":"U23BM102","name":"Engineering Mathematics","credits":4},{"code":"U23BM103","name":"Basic Electronics","credits":3},{"code":"U23BM104","name":"Programming in C","credits":3},{"code":"U23BM105","name":"Communication Skills","credits":2},{"code":"U23BM106","name":"Human Anatomy Lab","credits":1},{"code":"U23BM107","name":"Programming Lab","credits":1}],"2":[{"code":"U23BM201","name":"Human Physiology","credits":4},{"code":"U23BM202","name":"Biochemistry","credits":4},{"code":"U23BM203","name":"Medical Electronics","credits":4},{"code":"U23BM204","name":"Biomechanics","credits":3},{"code":"U23BM205","name":"Data Structures","credits":3},{"code":"U23BM206","name":"Human Physiology Lab","credits":1},{"code":"U23BM207","name":"Medical Electronics Lab","credits":1}]}},
            "FT": {"name":"Fashion Technology","color":"var(--ft-color)","icon":"fas fa-tshirt","semesters":{"1":[{"code":"U23FT101","name":"Fiber Science","credits":4},{"code":"U23FT102","name":"Textile Chemistry","credits":4},{"code":"U23FT103","name":"Fashion Illustration","credits":3},{"code":"U23FT104","name":"Pattern Making","credits":3},{"code":"U23FT105","name":"Communication Skills","credits":2},{"code":"U23FT106","name":"Textile Chemistry Lab","credits":1},{"code":"U23FT107","name":"Pattern Making Lab","credits":1}],"2":[{"code":"U23FT201","name":"Textile Processing","credits":4},{"code":"U23FT202","name":"Apparel Manufacturing","credits":4},{"code":"U23FT203","name":"Fashion Design","credits":4},{"code":"U23FT204","name":"Garment Construction","credits":3},{"code":"U23FT205","name":"Computer Applications","credits":3},{"code":"U23FT206","name":"Apparel Manufacturing Lab","credits":1},{"code":"U23FT207","name":"Garment Construction Lab","credits":1}]}},
            "MCT": {"name":"Mechatronics","color":"var(--mct-color)","icon":"fas fa-robot","semesters":{"1":[{"code":"U23MT101","name":"Engineering Mechanics","credits":4},{"code":"U23MT102","name":"Engineering Graphics","credits":4},{"code":"U23MT103","name":"Engineering Mathematics","credits":4},{"code":"U23MT104","name":"Basic Electronics","credits":3},{"code":"U23MT105","name":"Communication Skills","credits":2},{"code":"U23MT106","name":"Workshop Practice","credits":1},{"code":"U23MT107","name":"Engineering Graphics Lab","credits":1}],"2":[{"code":"U23MT201","name":"Thermodynamics","credits":4},{"code":"U23MT202","name":"Mechanics of Materials","credits":4},{"code":"U23MT203","name":"Digital Electronics","credits":4},{"code":"U23MT204","name":"Fluid Mechanics","credits":3},{"code":"U23MT205","name":"Computer Programming","credits":3},{"code":"U23MT206","name":"Thermodynamics Lab","credits":1},{"code":"U23MT207","name":"Digital Electronics Lab","credits":1}]}},
            "CSD": {"name":"CS & Design","color":"var(--csd-color)","icon":"fas fa-paint-brush","semesters":{"1":[{"code":"U23CD101","name":"Design Fundamentals","credits":4},{"code":"U23CD102","name":"Programming Basics","credits":4},{"code":"U23CD103","name":"Visual Communication","credits":3},{"code":"U23CD104","name":"Mathematics for Design","credits":3},{"code":"U23CD105","name":"Communication Skills","credits":2},{"code":"U23CD106","name":"Design Studio","credits":1},{"code":"U23CD107","name":"Programming Lab","credits":1}],"2":[{"code":"U23CD201","name":"User Interface Design","credits":4},{"code":"U23CD202","name":"Data Structures","credits":4},{"code":"U23CD203","name":"Web Design","credits":4},{"code":"U23CD204","name":"Digital Illustration","credits":3},{"code":"U23CD205","name":"Human-Computer Interaction","credits":3},{"code":"U23CD206","name":"UI Design Lab","credits":1},{"code":"U23CD207","name":"Web Design Lab","credits":1}]}},
            "ADS": {"name":"AI & Data Science","color":"var(--ads-color)","icon":"fas fa-database","semesters":{"1":[{"code":"U23DS101","name":"Programming Fundamentals","credits":4},{"code":"U23DS102","name":"Linear Algebra","credits":4},{"code":"U23DS103","name":"Statistics Basics","credits":3},{"code":"U23DS104","name":"Computational Thinking","credits":3},{"code":"U23DS105","name":"Communication Skills","credits":2},{"code":"U23DS106","name":"Programming Lab","credits":1},{"code":"U23DS107","name":"Statistics Lab","credits":1}],"2":[{"code":"U23DS201","name":"Data Structures","credits":4},{"code":"U23DS202","name":"Probability and Statistics","credits":4},{"code":"U23DS203","name":"Database Systems","credits":4},{"code":"U23DS204","name":"Data Visualization","credits":3},{"code":"U23DS205","name":"Python Programming","credits":3},{"code":"U23DS206","name":"Data Structures Lab","credits":1},{"code":"U23DS207","name":"Database Lab","credits":1}]}},
            "EFE": {"name":"Electrical & Computer","color":"var(--efe-color)","icon":"fas fa-microchip","semesters":{"1":[{"code":"U23EF101","name":"Circuit Theory","credits":4},{"code":"U23EF102","name":"Programming Fundamentals","credits":4},{"code":"U23EF103","name":"Digital Electronics","credits":3},{"code":"U23EF104","name":"Engineering Mathematics","credits":3},{"code":"U23EF105","name":"Communication Skills","credits":2},{"code":"U23EF106","name":"Circuit Theory Lab","credits":1},{"code":"U23EF107","name":"Programming Lab","credits":1}],"2":[{"code":"U23EF201","name":"Signals and Systems","credits":4},{"code":"U23EF202","name":"Data Structures","credits":4},{"code":"U23EF203","name":"Analog Electronics","credits":4},{"code":"U23EF204","name":"Electromagnetic Theory","credits":3},{"code":"U23EF205","name":"Computer Organization","credits":3},{"code":"U23EF206","name":"Analog Electronics Lab","credits":1},{"code":"U23EF207","name":"Data Structures Lab","credits":1}]}},
            "EXE": {"name":"Electronics & Computer","color":"var(--exe-color)","icon":"fas fa-desktop","semesters":{"1":[{"code":"U23EX101","name":"Basic Electronics","credits":4},{"code":"U23EX102","name":"Programming Fundamentals","credits":4},{"code":"U23EX103","name":"Digital Logic Design","credits":3},{"code":"U23EX104","name":"Engineering Mathematics","credits":3},{"code":"U23EX105","name":"Communication Skills","credits":2},{"code":"U23EX106","name":"Electronics Lab","credits":1},{"code":"U23EX107","name":"Programming Lab","credits":1}],"2":[{"code":"U23EX201","name":"Data Structures","credits":4},{"code":"U23EX202","name":"Analog Electronics","credits":4},{"code":"U23EX203","name":"Computer Organization","credits":4},{"code":"U23EX204","name":"Signals and Systems","credits":3},{"code":"U23EX205","name":"Database Systems","credits":3},{"code":"U23EX206","name":"Analog Electronics Lab","credits":1},{"code":"U23EX207","name":"Data Structures Lab","credits":1}]}}
        };
        
        // DOM Elements
        const authForm = document.getElementById('authForm');
        const messageArea = document.getElementById('message-area');
        const spinner = document.getElementById('spinner');
        const toggleLink = document.getElementById('toggle-link');
        const registrationFields = document.getElementById('registration-fields');
        const pageTransition = document.getElementById('page-transition');
        const forgotPasswordLink = document.getElementById('forgot-password-link');
        const forgotPasswordModal = document.getElementById('forgot-password-modal');
        const modalClose = document.getElementById('modal-close');
        const sendResetBtn = document.getElementById('send-reset-btn');
        const resetMessage = document.getElementById('reset-message');
        const resetEmail = document.getElementById('reset-email');
        const resetEmailError = document.getElementById('reset-email-error');
        const googleLoginBtn = document.getElementById('google-login');
        const microsoftLoginBtn = document.getElementById('microsoft-login');
        const githubLoginBtn = document.getElementById('github-login');
        const facebookLoginBtn = document.getElementById('facebook-login');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const passwordInput = document.getElementById('password');
        const passwordStrength = document.getElementById('password-strength');
        const strengthFill = document.getElementById('strength-fill');
        const strengthText = document.getElementById('strength-text');
        const submitBtn = document.getElementById('submit-btn');
        const submitBtnText = submitBtn.querySelector('.btn-text');
        const submitBtnSpinner = submitBtn.querySelector('.btn-spinner');
        const sendResetBtnText = sendResetBtn.querySelector('.btn-text');
        const sendResetBtnSpinner = sendResetBtn.querySelector('.btn-spinner');
        
        // Language selector elements
        const languageSelector = document.getElementById('language-selector');
        const currentLanguageElement = document.getElementById('current-language');
        
        // Role selection modal elements
        const roleSelectionModal = document.getElementById('role-selection-modal');
        const roleModalClose = document.getElementById('role-modal-close');
        const roleModalCancel = document.getElementById('role-modal-cancel');
        const roleModalConfirm = document.getElementById('role-modal-confirm');
        const roleOptions = document.querySelectorAll('.role-option');
        
        // Branch modal elements
        const branchModal = document.getElementById('branch-modal');
        const branchModalClose = document.getElementById('branch-modal-close');
        const branchGrid = document.getElementById('branch-grid');
        const semesterContainer = document.getElementById('semester-container');
        const semesterGrid = document.getElementById('semester-grid');
        const courseInfo = document.getElementById('course-info');
        const courseList = document.getElementById('course-list');
        const branchModalCancel = document.getElementById('branch-modal-cancel');
        const branchModalConfirm = document.getElementById('branch-modal-confirm');
        
        // Help modal elements
        const helpBtn = document.getElementById('chatbot-btn');
        const helpModal = document.getElementById('help-modal');
        const helpModalClose = document.getElementById('help-modal-close');
        
        // Terms and privacy modal elements
        const termsLink = document.getElementById('terms-link');
        const privacyLink = document.getElementById('privacy-link');
        const termsModal = document.getElementById('terms-modal');
        const termsModalClose = document.getElementById('terms-modal-close');
        const privacyModal = document.getElementById('privacy-modal');
        const privacyModalClose = document.getElementById('privacy-modal-close');
        const acceptTermsBtn = document.getElementById('accept-terms-btn');
        const acceptPrivacyBtn = document.getElementById('accept-privacy-btn');
        
        // Password toggle elements
        const passwordToggle = document.getElementById('password-toggle');
        const passwordToggleIcon = passwordToggle.querySelector('i');
        
        // Social registration modal elements
        const socialRegistrationModal = document.getElementById('social-registration-modal');
        const socialModalClose = document.getElementById('social-modal-close');
        const socialRegistrationForm = document.getElementById('social-registration-form');
        const socialAvatar = document.getElementById('social-avatar');
        const socialName = document.getElementById('social-name');
        const socialEmail = document.getElementById('social-email');
        const socialSubmitBtn = document.getElementById('social-submit-btn');
        const socialSubmitBtnText = socialSubmitBtn.querySelector('.btn-text');
        const socialSubmitBtnSpinner = socialSubmitBtn.querySelector('.btn-spinner');
        const socialMessage = document.getElementById('social-message');
        
        // State variables
        let isLogin = true;
        let isSocialSignup = false;
        let socialUserData = null;
        let selectedBranch = null;
        let selectedSemester = null;
        let selectedRole = null;
        let userLanguage = 'en';
        
        // Load saved theme
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        }
        
        // Load saved language
        const savedLanguage = localStorage.getItem('language');
        if (savedLanguage) {
            userLanguage = savedLanguage;
            updateLanguageDisplay();
        }
        
        // Dark mode toggle
        darkModeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
            darkModeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
        });
        
        // Language selector
        languageSelector.addEventListener('click', () => {
            languageSelector.classList.toggle('active');
        });
        
        // Language option selection
        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', () => {
                const lang = option.getAttribute('data-lang');
                userLanguage = lang;
                localStorage.setItem('language', lang);
                updateLanguageDisplay();
                languageSelector.classList.remove('active');
                
                // Save language preference to Firebase if user is logged in
                if (auth.currentUser) {
                    db.collection('users').doc(auth.currentUser.uid).update({
                        language: lang
                    });
                }
            });
        });
        
        // Update language display
        function updateLanguageDisplay() {
            const languageNames = {
                'en': 'English',
                'es': 'Spanish',
                'fr': 'French',
                'de': 'German',
                'zh': 'Chinese',
                'ja': 'Japanese'
            };
            
            currentLanguageElement.textContent = languageNames[userLanguage] || 'English';
            
            // Update active language option
            document.querySelectorAll('.language-option').forEach(option => {
                if (option.getAttribute('data-lang') === userLanguage) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
        }
        
        // Page transition effect
        function navigateToPage(url) {
            pageTransition.classList.add('active');
            setTimeout(() => {
                window.location.href = url;
            }, 500);
        }
        
        // Toast notification function
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.setAttribute('role', 'alert');
            toast.setAttribute('aria-live', 'polite');
            
            let icon = 'fa-info-circle';
            if (type === 'success') icon = 'fa-check-circle';
            if (type === 'error') icon = 'fa-exclamation-circle';
            
            toast.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${message}</span>
            `;
            
            document.getElementById('toast-container').appendChild(toast);
            
            // Trigger animation
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            // Remove toast after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }
        
        // Toggle between login and register
        toggleLink.addEventListener('click', () => {
            isLogin = !isLogin;
            updateAuthForm();
        });
        
        // Update auth form based on login/register state
        function updateAuthForm() {
            const formTitle = document.getElementById('form-title');
            const toggleText = document.getElementById('toggle-text');
            const nameGroup = document.getElementById('name-group');
            const admissionGroup = document.getElementById('admission-group');
            
            if (isLogin) {
                formTitle.textContent = 'Login';
                toggleText.textContent = "Don't have an account?";
                toggleLink.textContent = 'Register Now';
                nameGroup.style.display = 'none';
                admissionGroup.style.display = 'none';
                registrationFields.style.display = 'none';
                submitBtnText.textContent = 'Login';
            } else {
                formTitle.textContent = 'Register';
                toggleText.textContent = 'Already have an account?';
                toggleLink.textContent = 'Login Now';
                nameGroup.style.display = 'block';
                admissionGroup.style.display = 'block';
                registrationFields.style.display = 'block';
                submitBtnText.textContent = 'Register';
            }
            
            // Clear any previous messages
            messageArea.textContent = '';
            messageArea.className = 'message';
            
            // Clear form errors
            document.querySelectorAll('.form-group').forEach(group => {
                group.classList.remove('error');
            });
        }
        
        // Password visibility toggle
        passwordToggle.addEventListener('click', () => {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            
            // Toggle icon
            if (type === 'password') {
                passwordToggleIcon.classList.remove('fa-eye-slash');
                passwordToggleIcon.classList.add('fa-eye');
            } else {
                passwordToggleIcon.classList.remove('fa-eye');
                passwordToggleIcon.classList.add('fa-eye-slash');
            }
        });
        
        // Password strength checker
        passwordInput.addEventListener('input', () => {
            const password = passwordInput.value;
            
            if (password.length > 0) {
                passwordStrength.style.display = 'block';
                
                // Calculate password strength
                let strength = 0;
                
                // Length check
                if (password.length >= 8) strength += 25;
                
                // Contains lowercase
                if (/[a-z]/.test(password)) strength += 15;
                
                // Contains uppercase
                if (/[A-Z]/.test(password)) strength += 15;
                
                // Contains number
                if (/[0-9]/.test(password)) strength += 15;
                
                // Contains special character
                if (/[^A-Za-z0-9]/.test(password)) strength += 30;
                
                // Update strength bar
                strengthFill.style.width = `${strength}%`;
                
                // Update strength text
                if (strength < 30) {
                    strengthFill.className = 'strength-fill strength-weak';
                    strengthText.textContent = 'Weak password';
                } else if (strength < 60) {
                    strengthFill.className = 'strength-fill strength-medium';
                    strengthText.textContent = 'Medium strength';
                } else if (strength < 80) {
                    strengthFill.className = 'strength-fill strength-strong';
                    strengthText.textContent = 'Strong password';
                } else {
                    strengthFill.className = 'strength-fill strength-very-strong';
                    strengthText.textContent = 'Very strong password';
                }
            } else {
                passwordStrength.style.display = 'none';
            }
        });
        
        // Form submission
        authForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Get form values
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const name = document.getElementById('name').value;
            const admissionNo = document.getElementById('admissionNo').value;
            const branch = document.getElementById('branch').value;
            const semester = document.getElementById('semester').value;
            
            // Validate form
            if (!validateForm(email, password, isLogin ? '' : name, isLogin ? '' : admissionNo, isLogin ? '' : branch, isLogin ? '' : semester)) {
                return;
            }
            
            // Show loading
            submitBtn.classList.add('btn-loading');
            
            try {
                if (isLogin) {
                    // Login user
                    await auth.signInWithEmailAndPassword(email, password);
                    showToast('Login successful!', 'success');
                    
                    // Check user role and redirect accordingly
                    setTimeout(() => {
                        checkUserRoleAndRedirect();
                    }, 1000);
                } else {
                    // Register user
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    
                    // Update user profile
                    await user.updateProfile({
                        displayName: name
                    });
                    
                    // Save user data to Firestore
                    await db.collection('users').doc(user.uid).set({
                        name: name,
                        email: email,
                        admissionNo: admissionNo,
                        branch: branch,
                        semester: semester,
                        language: userLanguage,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    showToast('Registration successful!', 'success');
                    
                    // Check user role and redirect accordingly
                    setTimeout(() => {
                        checkUserRoleAndRedirect();
                    }, 1000);
                }
            } catch (error) {
                // Handle errors
                let errorMessage = '';
                
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'Email is already in use';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email address';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Password is too weak';
                        break;
                    case 'auth/user-not-found':
                        errorMessage = 'User not found';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password';
                        break;
                    default:
                        errorMessage = error.message;
                }
                
                messageArea.textContent = errorMessage;
                messageArea.className = 'message error';
            } finally {
                // Hide loading
                submitBtn.classList.remove('btn-loading');
            }
        });
        
        // Check user role and redirect accordingly
        async function checkUserRoleAndRedirect() {
            const user = auth.currentUser;
            if (!user) return;
            
            try {
                // Get user data from Firestore
                const userDoc = await db.collection('users').doc(user.uid).get();
                
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    const userRole = userData.role || 'student'; // Default to student if role is not set
                    
                    // Redirect based on role
                    switch (userRole) {
                        case 'admin':
                            navigateToPage('admindashboard.html');
                            break;
                        case 'faculty':
                            navigateToPage('facultydashboard.html');
                            break;
                        case 'student':
                        default:
                            navigateToPage('studentdashboard.html');
                            break;
                    }
                } else {
                    // User document doesn't exist, redirect to role selection
                    roleSelectionModal.classList.add('active');
                }
            } catch (error) {
                console.error('Error checking user role:', error);
                // Default to student dashboard
                navigateToPage('studentdashboard.html');
            }
        }
        
        // Form validation
        function validateForm(email, password, name, admissionNo, branch, semester) {
            let isValid = true;
            
            // Reset errors
            document.querySelectorAll('.form-group').forEach(group => {
                group.classList.remove('error');
            });
            document.querySelectorAll('.error-message').forEach(msg => {
                msg.textContent = '';
            });
            
            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) {
                document.getElementById('email-error').textContent = 'Please enter a valid email address';
                document.getElementById('email').closest('.form-group').classList.add('error');
                isValid = false;
            }
            
            // Validate password
            if (!password || password.length < 6) {
                document.getElementById('password-error').textContent = 'Password must be at least 6 characters';
                document.getElementById('password').closest('.form-group').classList.add('error');
                isValid = false;
            }
            
            // For registration, validate additional fields
            if (!isLogin) {
                if (!name || name.trim() === '') {
                    document.getElementById('name-error').textContent = 'Please enter your full name';
                    document.getElementById('name').closest('.form-group').classList.add('error');
                    isValid = false;
                }
                
                if (!admissionNo || admissionNo.trim() === '') {
                    document.getElementById('admission-error').textContent = 'Please enter your admission number';
                    document.getElementById('admissionNo').closest('.form-group').classList.add('error');
                    isValid = false;
                }
                
                if (!branch) {
                    document.getElementById('branch-error').textContent = 'Please select your branch';
                    document.getElementById('branch').closest('.form-group').classList.add('error');
                    isValid = false;
                }
                
                if (!semester) {
                    document.getElementById('semester-error').textContent = 'Please select your semester';
                    document.getElementById('semester').closest('.form-group').classList.add('error');
                    isValid = false;
                }
            }
            
            return isValid;
        }
        
        // Forgot password
        forgotPasswordLink.addEventListener('click', () => {
            forgotPasswordModal.classList.add('active');
        });
        
        modalClose.addEventListener('click', () => {
            forgotPasswordModal.classList.remove('active');
        });
        
        sendResetBtn.addEventListener('click', async () => {
            const email = resetEmail.value;
            
            if (!email) {
                resetEmailError.textContent = 'Please enter your email address';
                resetEmail.closest('.form-group').classList.add('error');
                return;
            }
            
            // Show loading
            sendResetBtn.classList.add('btn-loading');
            
            try {
                await auth.sendPasswordResetEmail(email);
                resetMessage.textContent = 'Password reset email sent!';
                resetMessage.className = 'message success';
                
                // Close modal after delay
                setTimeout(() => {
                    forgotPasswordModal.classList.remove('active');
                }, 2000);
            } catch (error) {
                resetMessage.textContent = error.message;
                resetMessage.className = 'message error';
            } finally {
                // Hide loading
                sendResetBtn.classList.remove('btn-loading');
            }
        });
        
        // Social login
        googleLoginBtn.addEventListener('click', () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            handleSocialLogin(provider);
        });
        
        microsoftLoginBtn.addEventListener('click', () => {
            const provider = new firebase.auth.OAuthProvider('microsoft.com');
            handleSocialLogin(provider);
        });
        
        githubLoginBtn.addEventListener('click', () => {
            const provider = new firebase.auth.GithubAuthProvider();
            handleSocialLogin(provider);
        });
        
        facebookLoginBtn.addEventListener('click', () => {
            const provider = new firebase.auth.FacebookAuthProvider();
            handleSocialLogin(provider);
        });
        
        function handleSocialLogin(provider) {
            auth.signInWithPopup(provider)
                .then((result) => {
                    // Check if user is new
                    if (result.additionalUserInfo.isNewUser) {
                        // Show social registration modal
                        socialUserData = {
                            uid: result.user.uid,
                            name: result.user.displayName,
                            email: result.user.email,
                            photoURL: result.user.photoURL
                        };
                        
                        // Populate social registration modal
                        socialAvatar.src = socialUserData.photoURL || 'https://via.placeholder.com/60';
                        socialName.textContent = socialUserData.name;
                        socialEmail.textContent = socialUserData.email;
                        
                        socialRegistrationModal.classList.add('active');
                    } else {
                        // Existing user, redirect to appropriate dashboard
                        showToast('Login successful!', 'success');
                        setTimeout(() => {
                            checkUserRoleAndRedirect();
                        }, 1000);
                    }
                })
                .catch((error) => {
                    messageArea.textContent = error.message;
                    messageArea.className = 'message error';
                });
        }
        
        // Social registration form submission
        socialRegistrationForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Get form values
            const admissionNo = document.getElementById('social-admission').value;
            const branch = document.getElementById('social-branch').value;
            const semester = document.getElementById('social-semester').value;
            const phone = document.getElementById('social-phone').value;
            
            // Validate form
            if (!validateSocialForm(admissionNo, branch, semester)) {
                return;
            }
            
            // Show loading
            socialSubmitBtn.classList.add('btn-loading');
            
            try {
                // Save user data to Firestore
                await db.collection('users').doc(socialUserData.uid).set({
                    name: socialUserData.name,
                    email: socialUserData.email,
                    admissionNo: admissionNo,
                    branch: branch,
                    semester: semester,
                    phone: phone,
                    photoURL: socialUserData.photoURL,
                    language: userLanguage,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                showToast('Registration successful!', 'success');
                
                // Close modal
                socialRegistrationModal.classList.remove('active');
                
                // Redirect to appropriate dashboard
                setTimeout(() => {
                    checkUserRoleAndRedirect();
                }, 1000);
            } catch (error) {
                socialMessage.textContent = error.message;
                socialMessage.className = 'message error';
            } finally {
                // Hide loading
                socialSubmitBtn.classList.remove('btn-loading');
            }
        });
        
        // Social form validation
        function validateSocialForm(admissionNo, branch, semester) {
            let isValid = true;
            
            // Reset errors
            document.querySelectorAll('.form-group').forEach(group => {
                group.classList.remove('error');
            });
            document.querySelectorAll('.error-message').forEach(msg => {
                msg.textContent = '';
            });
            
            if (!admissionNo || admissionNo.trim() === '') {
                document.getElementById('social-admission-error').textContent = 'Please enter your admission number';
                document.getElementById('social-admission').closest('.form-group').classList.add('error');
                isValid = false;
            }
            
            if (!branch) {
                document.getElementById('social-branch-error').textContent = 'Please select your branch';
                document.getElementById('social-branch').closest('.form-group').classList.add('error');
                isValid = false;
            }
            
            if (!semester) {
                document.getElementById('social-semester-error').textContent = 'Please select your semester';
                document.getElementById('social-semester').closest('.form-group').classList.add('error');
                isValid = false;
            }
            
            return isValid;
        }
        
        // Social modal close
        socialModalClose.addEventListener('click', () => {
            socialRegistrationModal.classList.remove('active');
        });
        
        // Role selection modal
        roleModalClose.addEventListener('click', () => {
            roleSelectionModal.classList.remove('active');
        });
        
        roleModalCancel.addEventListener('click', () => {
            roleSelectionModal.classList.remove('active');
        });
        
        // Role option selection
        roleOptions.forEach(option => {
            option.addEventListener('click', () => {
                // Remove selected class from all options
                roleOptions.forEach(opt => opt.classList.remove('selected'));
                
                // Add selected class to clicked option
                option.classList.add('selected');
                
                // Set selected role
                selectedRole = option.getAttribute('data-role');
            });
        });
        
        // Role modal confirm
        roleModalConfirm.addEventListener('click', async () => {
            if (!selectedRole) {
                showToast('Please select a role', 'error');
                return;
            }
            
            const user = auth.currentUser;
            if (!user) return;
            
            try {
                // Update user role in Firestore
                await db.collection('users').doc(user.uid).update({
                    role: selectedRole
                });
                
                // Close modal
                roleSelectionModal.classList.remove('active');
                
                // Redirect based on selected role
                switch (selectedRole) {
                    case 'admin':
                        navigateToPage('admindashboard.html');
                        break;
                    case 'faculty':
                        navigateToPage('facultydashboard.html');
                        break;
                    case 'student':
                    default:
                        navigateToPage('studentdashboard.html');
                        break;
                }
            } catch (error) {
                console.error('Error updating user role:', error);
                showToast('Failed to update role. Please try again.', 'error');
            }
        });
        
        // Branch modal
        function openBranchModal() {
            // Populate branch grid
            branchGrid.innerHTML = '';
            
            Object.keys(branches).forEach(branchCode => {
                const branch = branches[branchCode];
                
                const branchItem = document.createElement('div');
                branchItem.className = 'branch-item';
                branchItem.dataset.branch = branchCode;
                
                branchItem.innerHTML = `
                    <div class="branch-icon">
                        <i class="${branch.icon}"></i>
                    </div>
                    <div class="branch-name">${branch.name}</div>
                    <div class="branch-short">${branchCode}</div>
                `;
                
                branchItem.addEventListener('click', () => {
                    // Select branch
                    document.querySelectorAll('.branch-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    branchItem.classList.add('selected');
                    
                    selectedBranch = branchCode;
                    
                    // Show semester container
                    semesterContainer.classList.add('active');
                    
                    // Populate semester grid
                    semesterGrid.innerHTML = '';
                    
                    Object.keys(branch.semesters).forEach(semesterNum => {
                        const semesterItem = document.createElement('div');
                        semesterItem.className = 'semester-item';
                        semesterItem.dataset.semester = semesterNum;
                        
                        semesterItem.innerHTML = `
                            <div class="semester-number">${semesterNum}</div>
                            <div class="semester-text">Semester ${semesterNum}</div>
                        `;
                        
                        semesterItem.addEventListener('click', () => {
                            // Select semester
                            document.querySelectorAll('.semester-item').forEach(item => {
                                item.classList.remove('selected');
                            });
                            semesterItem.classList.add('selected');
                            
                            selectedSemester = semesterNum;
                            
                            // Show course info
                            courseInfo.classList.add('active');
                            
                            // Populate course list
                            courseList.innerHTML = '';
                            
                            branch.semesters[semesterNum].forEach(course => {
                                const courseItem = document.createElement('div');
                                courseItem.className = 'course-item';
                                
                                courseItem.innerHTML = `
                                    <span class="course-code">${course.code}</span>
                                    <span class="course-name">${course.name}</span>
                                    <span class="course-credits">${course.credits} credits</span>
                                `;
                                
                                courseList.appendChild(courseItem);
                            });
                        });
                        
                        semesterGrid.appendChild(semesterItem);
                    });
                });
                
                branchGrid.appendChild(branchItem);
            });
            
            branchModal.classList.add('active');
        }
        
        // Branch modal close
        branchModalClose.addEventListener('click', () => {
            branchModal.classList.remove('active');
        });
        
        branchModalCancel.addEventListener('click', () => {
            branchModal.classList.remove('active');
        });
        
        branchModalConfirm.addEventListener('click', () => {
            if (selectedBranch && selectedSemester) {
                // Update form fields
                document.getElementById('branch').value = selectedBranch;
                document.getElementById('semester').value = selectedSemester;
                
                // Close modal
                branchModal.classList.remove('active');
                
                showToast('Branch and semester selected successfully!', 'success');
            } else {
                showToast('Please select both branch and semester', 'error');
            }
        });
        
        // Help modal
        helpBtn.addEventListener('click', () => {
            helpModal.classList.add('active');
        });
        
        helpModalClose.addEventListener('click', () => {
            helpModal.classList.remove('active');
        });
        
        // Terms and privacy modals
        termsLink.addEventListener('click', (e) => {
            e.preventDefault();
            termsModal.classList.add('active');
        });
        
        privacyLink.addEventListener('click', (e) => {
            e.preventDefault();
            privacyModal.classList.add('active');
        });
        
        termsModalClose.addEventListener('click', () => {
            termsModal.classList.remove('active');
        });
        
        privacyModalClose.addEventListener('click', () => {
            privacyModal.classList.remove('active');
        });
        
        acceptTermsBtn.addEventListener('click', () => {
            termsModal.classList.remove('active');
        });
        
        acceptPrivacyBtn.addEventListener('click', () => {
            privacyModal.classList.remove('active');
        });
        
        // Initialize branch modal for registration
        document.getElementById('branch').addEventListener('click', () => {
            openBranchModal();
        });
        
        // Check if user is already logged in
        auth.onAuthStateChanged((user) => {
            if (user) {
                // User is signed in
                // Get user data from Firestore
                db.collection('users').doc(user.uid).get().then((doc) => {
                    if (doc.exists) {
                        const userData = doc.data();
                        
                        // Update user language if available
                        if (userData.language) {
                            userLanguage = userData.language;
                            localStorage.setItem('language', userLanguage);
                            updateLanguageDisplay();
                        }
                        
                        // If user doesn't have a role, show role selection modal
                        if (!userData.role) {
                            roleSelectionModal.classList.add('active');
                        }
                    } else {
                        // User document doesn't exist, show role selection modal
                        roleSelectionModal.classList.add('active');
                    }
                }).catch((error) => {
                    console.error('Error getting user data:', error);
                    // Default to student dashboard
                    navigateToPage('studentdashboard.html');
                });
            }
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard | IB STUDIOZ</title>
    
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%23FFD700' d='M50,2 A48,48 0 1,0 50,98 A48,48 0 1,0 50,2 Z' /%3E%3Cg fill='%230A0A0A'%3E%3Cpath d='M28,25 h10 v50 h-10 Z' /%3E%3Cpath d='M45,25 H60 A12.5,12.5 0 0,1 60,50 H45 Z M45,50 H63 A12.5,12.5 0 0,1 63,75 H45 Z' /%3E%3C/g%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-glow: #FFD700; --secondary-glow: #00A2FF; --accent-glow: #FF6B6B; --dark-bg: #0A0A0A;
            --text-primary: #F0F0F0; --text-secondary: #A0A0A0; --text-muted: #666; --card-bg: rgba(22, 22, 22, 0.8);
            --border-color: rgba(255, 215, 0, 0.2); --shadow-color: rgba(0, 0, 0, 0.5);
            --danger: #e74c3c; --success: #2ecc71; --info: #3498db; --details: #9b59b6; --warning: #f39c12;
            --glass-bg: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif; background-color: var(--dark-bg);
            color: var(--text-primary); line-height: 1.6; min-height: 100vh;
            opacity: 0; animation: page-fade-in 0.8s ease-out forwards;
        }
        @keyframes page-fade-in { to { opacity: 1; } }
        
        /* Enhanced Background */
        .background-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; overflow: hidden; }
        .aurora-layer { position: absolute; top: 0; left: 0; width: 120%; height: 120%; 
            background: 
                radial-gradient(circle at 10% 20%, var(--primary-glow) 0%, transparent 25%), 
                radial-gradient(circle at 80% 30%, var(--secondary-glow) 0%, transparent 30%), 
                radial-gradient(circle at 50% 80%, var(--accent-glow) 0%, transparent 25%),
                radial-gradient(circle at 20% 70%, var(--details) 0%, transparent 35%); 
            animation: aurora-morph 60s linear infinite alternate; 
            filter: blur(140px); opacity: 0.15; 
        }
        @keyframes aurora-morph { 
            0% { transform: rotate(0deg) scale(1.2); } 
            50% { transform: rotate(180deg) scale(1.5); } 
            100% { transform: rotate(360deg) scale(1.8); } 
        }
        .noise-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; 
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 800"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23noise)"/></svg>'); 
            opacity: 0.02; 
        }
        
        /* Enhanced Header */
        .page-header { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 20px 40px; margin: 20px; 
            background: var(--glass-bg); backdrop-filter: blur(25px); 
            border-radius: 20px; border: 1px solid var(--glass-border); 
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            position: relative; overflow: hidden;
        }
        .page-header::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary-glow), transparent);
            opacity: 0.5;
        }
        .brand-logo { display: flex; align-items: center; gap: 15px; text-decoration: none; }
        .header-logo-svg { width: 50px; height: auto; filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3)); }
        .brand-title { 
            position: relative; font-size: 1.6rem; font-weight: 800; 
            background: linear-gradient(135deg, #ff00ff, #00ffea, #ffdd00, #ff6b6b, #ff00ff); 
            background-size: 400% 100%; -webkit-background-clip: text; background-clip: text; 
            color: transparent; animation: rgb-text-flow 8s linear infinite; 
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        @keyframes rgb-text-flow { to { background-position: 400% 0; } }
        
        /* Enhanced Buttons */
        .btn-secondary { 
            background: var(--glass-bg); border: 1px solid var(--glass-border); 
            color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; 
            font-size: 0.9rem; font-weight: 600; cursor: pointer; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            backdrop-filter: blur(10px); position: relative; overflow: hidden;
        }
        .btn-secondary::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,215,0,0.1), transparent);
            transition: left 0.5s ease;
        }
        .btn-secondary:hover::before { left: 100%; }
        .btn-secondary:hover { 
            background: var(--primary-glow); color: var(--dark-bg); 
            border-color: var(--primary-glow); 
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.4); 
            transform: translateY(-2px);
        }
        
        /* Dashboard Overview Cards */
        .dashboard-overview {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; margin: 20px 0 40px 0; padding: 0 20px;
        }
        .overview-card {
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border-radius: 16px; border: 1px solid var(--glass-border);
            padding: 20px; text-align: center; position: relative; overflow: hidden;
            transition: all 0.3s ease; animation: card-fade-in 0.6s ease-out forwards;
            opacity: 0;
        }
        .overview-card:nth-child(1) { animation-delay: 0.1s; }
        .overview-card:nth-child(2) { animation-delay: 0.2s; }
        .overview-card:nth-child(3) { animation-delay: 0.3s; }
        .overview-card:nth-child(4) { animation-delay: 0.4s; }
        .overview-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, transparent, rgba(255,215,0,0.05), transparent);
            opacity: 0; transition: opacity 0.3s ease;
        }
        .overview-card:hover::before { opacity: 1; }
        .overview-card:hover { transform: translateY(-5px) scale(1.02); }
        .overview-number {
            font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;
            background: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        .overview-label { font-size: 0.9rem; color: var(--text-secondary); font-weight: 500; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .hidden { display: none !important; }
        
        /* Enhanced Welcome Section */
        .welcome-header-pro { 
            padding: 50px 0; margin-bottom: 40px; text-align: left; 
            border-left: 5px solid; 
            border-image: linear-gradient(135deg, var(--primary-glow), var(--secondary-glow), var(--accent-glow)) 1; 
            padding-left: 40px; position: relative;
        }
        .welcome-header-pro::after {
            content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 5px;
            background: linear-gradient(135deg, var(--primary-glow), var(--secondary-glow), var(--accent-glow));
            filter: blur(3px); opacity: 0.7;
        }
        .welcome-header-pro h1 { 
            font-size: clamp(2.5rem, 5vw, 3.8rem); font-weight: 800; 
            line-height: 1.1; margin-bottom: 15px; 
            background: linear-gradient(135deg, var(--text-primary), var(--primary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        #student-name { 
            color: var(--primary-glow); text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            animation: glow-pulse 2s ease-in-out infinite alternate;
        }
        @keyframes glow-pulse { 
            from { text-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
            to { text-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 40px rgba(255, 215, 0, 0.3); }
        }
        .welcome-header-pro p { 
            font-size: 1.2rem; color: var(--text-secondary); max-width: 700px; 
            font-weight: 400; letter-spacing: 0.5px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
            gap: 30px; margin-bottom: 60px; 
        }
        
        /* Enhanced Navigation Cards */
        .nav-card { 
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border-radius: 20px; border: 1px solid var(--glass-border); 
            padding: 35px 30px; text-decoration: none; 
            box-shadow: 0 12px 40px rgba(0,0,0,0.3); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            cursor: pointer; opacity: 0; 
            animation: card-fade-in 0.6s ease-out forwards;
            position: relative; overflow: hidden;
        }
        .nav-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at center, transparent 40%, var(--card-color, var(--primary-glow)) 140%);
            opacity: 0; transition: opacity 0.3s ease; z-index: -1;
        }
        .nav-card:hover::before { opacity: 0.03; }
        @keyframes card-fade-in { 
            from { opacity: 0; transform: translateY(30px) scale(0.95); } 
            to { opacity: 1; transform: translateY(0) scale(1); } 
        }
        .nav-card:nth-child(1) { animation-delay: 0.1s; } 
        .nav-card:nth-child(2) { animation-delay: 0.2s; } 
        .nav-card:nth-child(3) { animation-delay: 0.3s; }
        .nav-card:nth-child(4) { animation-delay: 0.4s; } 
        .nav-card:nth-child(5) { animation-delay: 0.5s; }
        .nav-card:hover { 
            transform: translateY(-12px) scale(1.02); 
            border-color: var(--card-color, var(--primary-glow)); 
            box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 40px var(--card-color, var(--primary-glow))20;
        }
        .nav-card-header { 
            display: flex; align-items: center; justify-content: space-between; 
            margin-bottom: 20px; 
        }
        .nav-card-icon { 
            font-size: 2.8rem; color: var(--card-color, var(--primary-glow)); 
            transition: all 0.4s ease; filter: drop-shadow(0 0 10px var(--card-color, var(--primary-glow))30);
        }
        .nav-card:hover .nav-card-icon { 
            transform: scale(1.15) rotate(5deg); 
            filter: drop-shadow(0 0 20px var(--card-color, var(--primary-glow))50);
        }
        .nav-card-arrow { 
            font-size: 1.8rem; color: var(--text-secondary); opacity: 0; 
            transform: translateX(-15px); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .nav-card:hover .nav-card-arrow { 
            opacity: 1; transform: translateX(5px); 
            color: var(--card-color, var(--primary-glow));
        }
        .nav-card h3 { 
            font-size: 1.4rem; margin-bottom: 10px; color: var(--text-primary); 
            text-align: left; font-weight: 700; letter-spacing: 0.5px;
        }
        .nav-card p { 
            color: var(--text-secondary); font-size: 0.95rem; text-align: left; 
            line-height: 1.5; font-weight: 400;
        }
        
        /* Feature Tabs */
        .feature-tabs {
            display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 30px;
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border-radius: 16px; border: 1px solid var(--glass-border);
            padding: 15px;
        }
        .feature-tab {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 30px; padding: 10px 20px; font-size: 0.9rem;
            font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            color: var(--text-secondary);
        }
        .feature-tab.active {
            background: var(--primary-glow); color: var(--dark-bg);
            border-color: var(--primary-glow);
        }
        .feature-tab:hover:not(.active) {
            background: rgba(255,255,255,0.1); border-color: var(--primary-glow);
            color: var(--text-primary);
        }
        
        /* Feature Content */
        .feature-content {
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border-radius: 20px; border: 1px solid var(--glass-border);
            padding: 30px; margin-bottom: 40px;
            min-height: 400px;
        }
        .feature-panel {
            display: none;
        }
        .feature-panel.active {
            display: block;
            animation: fade-in 0.5s ease;
        }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Badges Section */
        .badges-container {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px; margin-top: 20px;
        }
        .badge-item {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; padding: 20px; text-align: center;
            transition: all 0.3s ease;
        }
        .badge-item:hover {
            background: rgba(255,255,255,0.1); border-color: var(--primary-glow);
            transform: translateY(-5px);
        }
        .badge-icon {
            font-size: 3rem; margin-bottom: 15px;
            color: var(--primary-glow);
        }
        .badge-name {
            font-size: 1rem; font-weight: 600; margin-bottom: 5px;
            color: var(--text-primary);
        }
        .badge-desc {
            font-size: 0.8rem; color: var(--text-secondary);
        }
        .badge-earned {
            position: relative;
        }
        .badge-earned::after {
            content: '✓'; position: absolute; top: 10px; right: 10px;
            background: var(--success); color: var(--dark-bg);
            width: 24px; height: 24px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold;
        }
        
        /* Resume Builder */
        .resume-builder {
            display: grid; grid-template-columns: 1fr 2fr; gap: 30px;
        }
        .resume-sections {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px;
        }
        .resume-section {
            margin-bottom: 15px; padding: 15px;
            background: rgba(255,255,255,0.03); border-radius: 8px;
            cursor: pointer; transition: all 0.3s ease;
        }
        .resume-section:hover {
            background: rgba(255,255,255,0.06); border-left: 3px solid var(--primary-glow);
        }
        .resume-section.active {
            background: rgba(255,215,0,0.1); border-left: 3px solid var(--primary-glow);
        }
        .resume-preview {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 30px;
            min-height: 500px;
        }
        .resume-form {
            display: none;
        }
        .resume-form.active {
            display: block;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block; margin-bottom: 8px;
            font-weight: 600; color: var(--text-primary);
        }
        .form-input, .form-textarea {
            width: 100%; padding: 12px 15px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px; color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none; border-color: var(--primary-glow);
            background: rgba(255,255,255,0.08);
        }
        .form-textarea {
            min-height: 120px; resize: vertical;
        }
        .btn-primary {
            background: var(--primary-glow); color: var(--dark-bg);
            border: none; padding: 12px 24px; border-radius: 8px;
            font-weight: 600; cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: #ffcc00; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,215,0,0.3);
        }
        
        /* AI Assistant */
        .ai-assistant-container {
            display: grid; grid-template-columns: 1fr 1fr; gap: 30px;
            height: 500px;
        }
        .ai-chat {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px;
            display: flex; flex-direction: column;
        }
        .ai-chat-header {
            display: flex; align-items: center; gap: 15px;
            margin-bottom: 20px; padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .ai-avatar {
            width: 50px; height: 50px; border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-glow), var(--secondary-glow));
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; color: var(--dark-bg);
        }
        .ai-status {
            display: flex; align-items: center; gap: 8px;
            font-size: 0.9rem; color: var(--text-secondary);
        }
        .status-dot {
            width: 10px; height: 10px; border-radius: 50%;
            background: var(--success); animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }
        .ai-messages {
            flex: 1; overflow-y: auto; margin-bottom: 20px;
            padding-right: 10px;
        }
        .ai-messages::-webkit-scrollbar { width: 6px; }
        .ai-messages::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 3px; }
        .ai-messages::-webkit-scrollbar-thumb { 
            background: var(--primary-glow); border-radius: 3px; 
        }
        .message {
            margin-bottom: 15px; display: flex;
        }
        .message.user {
            justify-content: flex-end;
        }
        .message-bubble {
            max-width: 80%; padding: 12px 18px;
            border-radius: 18px; font-size: 0.9rem;
            line-height: 1.4;
        }
        .message.ai .message-bubble {
            background: rgba(255,255,255,0.1); border-top-left-radius: 4px;
            color: var(--text-primary);
        }
        .message.user .message-bubble {
            background: var(--primary-glow); color: var(--dark-bg);
            border-top-right-radius: 4px;
        }
        .ai-input-container {
            display: flex; gap: 10px;
        }
        .ai-input {
            flex: 1; padding: 12px 18px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 30px; color: var(--text-primary);
            font-family: 'Inter', sans-serif;
        }
        .ai-input:focus {
            outline: none; border-color: var(--primary-glow);
        }
        .ai-send {
            width: 45px; height: 45px; border-radius: 50%;
            background: var(--primary-glow); color: var(--dark-bg);
            border: none; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.3s ease;
        }
        .ai-send:hover {
            background: #ffcc00; transform: scale(1.05);
        }
        .ai-features {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px;
        }
        .ai-feature-title {
            font-size: 1.2rem; font-weight: 700; margin-bottom: 20px;
            color: var(--text-primary);
        }
        .ai-feature-list {
            list-style: none;
        }
        .ai-feature-item {
            display: flex; align-items: center; gap: 15px;
            padding: 15px; margin-bottom: 10px;
            background: rgba(255,255,255,0.03); border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .ai-feature-item:hover {
            background: rgba(255,255,255,0.06); border-left: 3px solid var(--primary-glow);
        }
        .ai-feature-icon {
            width: 40px; height: 40px; border-radius: 8px;
            background: rgba(255,215,0,0.1); color: var(--primary-glow);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem;
        }
        .ai-feature-name {
            font-weight: 600; color: var(--text-primary);
        }
        
        /* Time Tracker */
        .time-tracker-container {
            display: grid; grid-template-columns: 1fr 1fr; gap: 30px;
        }
        .tracker-timer {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 30px; text-align: center;
        }
        .timer-display {
            font-size: 4rem; font-weight: 700; margin: 20px 0;
            background: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        .timer-controls {
            display: flex; justify-content: center; gap: 15px;
            margin-top: 30px;
        }
        .timer-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-primary); font-size: 1.5rem;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.3s ease;
        }
        .timer-btn:hover {
            background: rgba(255,255,255,0.1); border-color: var(--primary-glow);
            transform: scale(1.05);
        }
        .timer-btn.primary {
            background: var(--primary-glow); color: var(--dark-bg);
            border-color: var(--primary-glow);
        }
        .timer-btn.primary:hover {
            background: #ffcc00;
        }
        .tracker-activities {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px;
        }
        .activity-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
        }
        .activity-title {
            font-size: 1.2rem; font-weight: 700;
            color: var(--text-primary);
        }
        .activity-list {
            max-height: 400px; overflow-y: auto;
        }
        .activity-list::-webkit-scrollbar { width: 6px; }
        .activity-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 3px; }
        .activity-list::-webkit-scrollbar-thumb { 
            background: var(--primary-glow); border-radius: 3px; 
        }
        .activity-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; margin-bottom: 10px;
            background: rgba(255,255,255,0.03); border-radius: 8px;
            transition: all 0.3s ease;
        }
        .activity-item:hover {
            background: rgba(255,255,255,0.06);
        }
        .activity-name {
            font-weight: 600; color: var(--text-primary);
        }
        .activity-time {
            color: var(--text-secondary);
        }
        .activity-progress {
            height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px;
            margin-top: 8px; overflow: hidden;
        }
        .activity-progress-bar {
            height: 100%; background: var(--primary-glow); border-radius: 2px;
        }
        
        /* Virtual Currency */
        .currency-container {
            display: grid; grid-template-columns: 1fr 2fr; gap: 30px;
        }
        .currency-balance {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 30px; text-align: center;
        }
        .currency-icon {
            font-size: 3rem; margin-bottom: 20px;
            color: var(--primary-glow);
        }
        .currency-amount {
            font-size: 3.5rem; font-weight: 800; margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        .currency-label {
            font-size: 1.2rem; color: var(--text-secondary);
        }
        .currency-actions {
            display: flex; justify-content: center; gap: 15px;
            margin-top: 30px;
        }
        .currency-btn {
            padding: 12px 24px; border-radius: 8px;
            font-weight: 600; cursor: pointer;
            transition: all 0.3s ease;
        }
        .currency-btn.earn {
            background: var(--success); color: var(--dark-bg);
            border: none;
        }
        .currency-btn.spend {
            background: transparent; color: var(--primary-glow);
            border: 1px solid var(--primary-glow);
        }
        .currency-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .currency-transactions {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px;
        }
        .transaction-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
        }
        .transaction-title {
            font-size: 1.2rem; font-weight: 700;
            color: var(--text-primary);
        }
        .transaction-list {
            max-height: 400px; overflow-y: auto;
        }
        .transaction-list::-webkit-scrollbar { width: 6px; }
        .transaction-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 3px; }
        .transaction-list::-webkit-scrollbar-thumb { 
            background: var(--primary-glow); border-radius: 3px; 
        }
        .transaction-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; margin-bottom: 10px;
            background: rgba(255,255,255,0.03); border-radius: 8px;
            transition: all 0.3s ease;
        }
        .transaction-item:hover {
            background: rgba(255,255,255,0.06);
        }
        .transaction-details {
            display: flex; align-items: center; gap: 15px;
        }
        .transaction-icon {
            width: 40px; height: 40px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem;
        }
        .transaction-icon.earn {
            background: rgba(46,204,113,0.1); color: var(--success);
        }
        .transaction-icon.spend {
            background: rgba(231,76,60,0.1); color: var(--danger);
        }
        .transaction-info {
            display: flex; flex-direction: column;
        }
        .transaction-desc {
            font-weight: 600; color: var(--text-primary);
        }
        .transaction-date {
            font-size: 0.8rem; color: var(--text-muted);
        }
        .transaction-amount {
            font-weight: 700; font-size: 1.1rem;
        }
        .transaction-amount.earn {
            color: var(--success);
        }
        .transaction-amount.spend {
            color: var(--danger);
        }
        
        /* Leaderboard */
        .leaderboard-container {
            display: grid; grid-template-columns: 1fr 2fr; gap: 30px;
        }
        .leaderboard-rank {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 30px; text-align: center;
        }
        .rank-position {
            font-size: 5rem; font-weight: 800; margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        .rank-label {
            font-size: 1.2rem; color: var(--text-secondary);
        }
        .rank-medal {
            font-size: 4rem; margin: 20px 0;
        }
        .rank-medal.gold { color: #FFD700; }
        .rank-medal.silver { color: #C0C0C0; }
        .rank-medal.bronze { color: #CD7F32; }
        .leaderboard-list {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px;
        }
        .leaderboard-table {
            width: 100%; border-collapse: collapse;
        }
        .leaderboard-table th {
            text-align: left; padding: 15px; font-weight: 600;
            color: var(--text-secondary); border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .leaderboard-table td {
            padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .leaderboard-table tr:last-child td {
            border-bottom: none;
        }
        .leaderboard-table tr:hover {
            background: rgba(255,255,255,0.03);
        }
        .leaderboard-rank-col {
            font-weight: 700; font-size: 1.1rem;
            width: 60px;
        }
        .leaderboard-name-col {
            font-weight: 600; color: var(--text-primary);
        }
        .leaderboard-score-col {
            font-weight: 700; color: var(--primary-glow);
            text-align: right;
        }
        .leaderboard-table tr.current-user {
            background: rgba(255,215,0,0.1);
        }
        .leaderboard-table tr.current-user td {
            border-bottom: 1px solid rgba(255,215,0,0.2);
        }
        
        /* Notices Section */
        .notices-section {
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border-radius: 20px; border: 1px solid var(--glass-border);
            padding: 30px; margin-bottom: 40px;
            position: relative; overflow: hidden;
        }
        .notices-section::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary-glow), transparent);
            opacity: 0.5;
        }
        .section-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid var(--glass-border);
        }
        .section-title {
            font-size: 1.8rem; font-weight: 700;
            background: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        .notices-list {
            max-height: 400px; overflow-y: auto;
        }
        .notices-list::-webkit-scrollbar { width: 8px; }
        .notices-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 4px; }
        .notices-list::-webkit-scrollbar-thumb { 
            background: linear-gradient(135deg, var(--primary-glow), var(--secondary-glow)); 
            border-radius: 4px; 
        }
        .notice-item {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px; margin-bottom: 15px;
            transition: all 0.3s ease; position: relative;
        }
        .notice-item:hover {
            background: rgba(255,255,255,0.06); border-color: rgba(255,215,0,0.3);
            transform: translateX(5px);
        }
        .notice-item.important {
            border-left: 4px solid var(--danger);
        }
        .notice-title {
            font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;
            color: var(--text-primary);
        }
        .notice-message {
            color: var(--text-secondary); margin-bottom: 15px;
            line-height: 1.5;
        }
        .notice-meta {
            display: flex; justify-content: space-between; align-items: center;
            font-size: 0.85rem; color: var(--text-muted);
        }
        .notice-time {
            display: flex; align-items: center; gap: 5px;
        }
        .notice-badge {
            background: var(--primary-glow); color: var(--dark-bg);
            padding: 4px 10px; border-radius: 20px; font-size: 0.75rem;
            font-weight: 600;
        }
        
        /* Recent Materials Section */
        .materials-section {
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border-radius: 20px; border: 1px solid var(--glass-border);
            padding: 30px; margin-bottom: 40px;
            position: relative; overflow: hidden;
        }
        .materials-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px; margin-top: 20px;
        }
        .material-card {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px; transition: all 0.3s ease;
        }
        .material-card:hover {
            background: rgba(255,255,255,0.06); border-color: rgba(255,215,0,0.3);
            transform: translateY(-5px);
        }
        .material-icon {
            font-size: 2.5rem; margin-bottom: 15px;
            color: var(--primary-glow);
        }
        .material-title {
            font-size: 1.1rem; font-weight: 600; margin-bottom: 10px;
            color: var(--text-primary);
        }
        .material-meta {
            font-size: 0.85rem; color: var(--text-muted);
        }
        
        /* Enhanced Modals */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(10,10,10,0.8); backdrop-filter: blur(15px); 
            display: flex; justify-content: center; align-items: center; z-index: 2000; 
            opacity: 0; visibility: hidden; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal { 
            background: var(--glass-bg); backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border); border-radius: 20px; 
            width: 90%; max-width: 900px; padding: 40px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.5); 
            transform: scale(0.9) translateY(20px); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative; overflow: hidden;
        }
        .modal::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary-glow), transparent);
            opacity: 0.6;
        }
        .modal-overlay.active .modal { transform: scale(1) translateY(0); }
        .modal-header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 25px; border-bottom: 1px solid var(--border-color); 
            padding-bottom: 20px; 
        }
        .modal-header h2 { 
            font-size: 1.6rem; font-weight: 700; 
            background: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }
        .modal-close { 
            background: none; border: none; color: var(--text-primary); 
            font-size: 2rem; cursor: pointer; width: 40px; height: 40px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            transition: all 0.3s ease; 
        }
        .modal-close:hover { 
            background: rgba(255,255,255,0.1); transform: rotate(90deg); 
            color: var(--accent-glow);
        }
        
        /* Enhanced Toast */
        .toast { 
            position: fixed; bottom: 30px; right: 30px; 
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: 12px; 
            padding: 18px 24px; box-shadow: 0 12px 40px rgba(0,0,0,0.4); 
            z-index: 3000; display: flex; align-items: center; gap: 12px;
            transform: translateX(400px); opacity: 0; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            min-width: 300px;
        }
        .toast.show { transform: translateX(0); opacity: 1; }
        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.info { border-left: 4px solid var(--info); }
        .toast i { font-size: 1.3rem; }
        .toast.success i { color: var(--success); }
        .toast.error i { color: var(--danger); }
        .toast.info i { color: var(--info); }
        
        /* Loading Spinner */
        .spinner-container { display: flex; justify-content: center; align-items: center; height: 120px; }
        .spinner { 
            width: 50px; height: 50px; 
            border: 4px solid rgba(255, 255, 255, 0.1); border-radius: 50%; 
            border-top-color: var(--primary-glow); 
            animation: spin 1s cubic-bezier(0.4, 0, 0.2, 1) infinite; 
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Empty State */
        .empty-state {
            text-align: center; padding: 40px 20px;
            color: var(--text-muted);
        }
        .empty-icon {
            font-size: 3rem; margin-bottom: 15px; opacity: 0.5;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .page-header { flex-direction: column; gap: 20px; margin: 15px; padding: 25px 20px; }
            .welcome-header-pro { padding-left: 25px; margin-bottom: 30px; }
            .dashboard-grid { grid-template-columns: 1fr; gap: 20px; }
            .dashboard-overview { grid-template-columns: repeat(2, 1fr); }
            .materials-grid { grid-template-columns: 1fr; }
            .section-header { flex-direction: column; align-items: flex-start; gap: 10px; }
            .modal { padding: 30px 20px; }
            
            /* Feature responsive */
            .ai-assistant-container, .resume-builder, .time-tracker-container,
            .currency-container, .leaderboard-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .dashboard-overview { grid-template-columns: 1fr; }
            .overview-number { font-size: 2rem; }
            .welcome-header-pro h1 { font-size: 2rem; }
            .nav-card { padding: 25px 20px; }
            .nav-card h3 { font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="background-container">
        <div class="aurora-layer"></div>
        <div class="noise-layer"></div>
    </div>
    
    <main>
        <header class="page-header">
            <a href="/studentdashboard.html" class="brand-logo">
                <svg class="header-logo-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--primary-glow)" d="M50,2 A48,48 0 1,0 50,98 A48,48 0 1,0 50,2 Z" />
                    <g fill="var(--dark-bg)">
                        <path d="M28,25 h10 v50 h-10 Z" />
                        <path d="M45,25 H60 A12.5,12.5 0 0,1 60,50 H45 Z M45,50 H63 A12.5,12.5 0 0,1 63,75 H45 Z" />
                    </g>
                </svg>
                <h1 class="brand-title">IB STUDIOZ</h1>
            </a>
            <div style="display: flex; gap: 15px; align-items: center;">
                <button id="profile-btn" class="btn-secondary">
                    <i class="fas fa-user"></i> Profile
                </button>
                <button id="logout-btn" class="btn-secondary">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </header>
        
        <div class="container">
            <!-- Dashboard Overview Cards -->
            <div class="dashboard-overview">
                <div class="overview-card">
                    <div class="overview-number" id="materials-count">0</div>
                    <div class="overview-label">Materials</div>
                </div>
                <div class="overview-card">
                    <div class="overview-number" id="pyqs-count">0</div>
                    <div class="overview-label">PYQs</div>
                </div>
                <div class="overview-card">
                    <div class="overview-number" id="seminars-count">0</div>
                    <div class="overview-label">Seminars</div>
                </div>
                <div class="overview-card">
                    <div class="overview-number" id="credits-count">0</div>
                    <div class="overview-label">Credits</div>
                </div>
            </div>
            
            <div class="welcome-header-pro">
                <h1>Student Dashboard</h1>
                <p>Welcome back, <span id="student-name">Student</span>. Access your learning materials and stay updated with the latest announcements.</p>
            </div>
            
            <!-- Feature Tabs -->
            <div class="feature-tabs">
                <div class="feature-tab active" data-tab="dashboard">Dashboard</div>
                <div class="feature-tab" data-tab="badges">Badges</div>
                <div class="feature-tab" data-tab="resume">Resume Builder</div>
                <div class="feature-tab" data-tab="ai-assistant">AI Assistant</div>
                <div class="feature-tab" data-tab="time-tracker">Time Tracker</div>
                <div class="feature-tab" data-tab="credits">Virtual Currency</div>
                <div class="feature-tab" data-tab="leaderboard">Leaderboard</div>
            </div>
            
            <!-- Feature Content -->
            <div class="feature-content">
                <!-- Dashboard Panel -->
                <div class="feature-panel active" id="dashboard-panel">
                    <!-- Notices Section -->
                    <div class="notices-section">
                        <div class="section-header">
                            <h2 class="section-title"><i class="fas fa-bullhorn"></i> Notices & Announcements</h2>
                            <span class="notice-badge" id="new-notices-badge" style="display: none;">New</span>
                        </div>
                        <div class="notices-list" id="notices-list">
                            <div class="spinner-container">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Materials Section -->
                    <div class="materials-section">
                        <div class="section-header">
                            <h2 class="section-title"><i class="fas fa-book"></i> Recent Materials</h2>
                            <a href="/materials.html" class="btn-secondary">View All</a>
                        </div>
                        <div class="materials-grid" id="recent-materials">
                            <div class="spinner-container">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Access Section -->
                    <section class="dashboard-grid">
                        <a href="/materials.html" class="nav-card" style="--card-color: #2575fc;">
                            <div class="nav-card-header">
                                <div class="nav-card-icon"><i class="fas fa-book-open"></i></div>
                                <span class="nav-card-arrow">→</span>
                            </div>
                            <h3>Study Materials</h3>
                            <p>Access notes, e-books, and other learning resources for your courses.</p>
                        </a>
                        
                        <a href="/pyq.html" class="nav-card" style="--card-color: #f857a6;">
                            <div class="nav-card-header">
                                <div class="nav-card-icon"><i class="fas fa-file-alt"></i></div>
                                <span class="nav-card-arrow">→</span>
                            </div>
                            <h3>Previous Year Papers</h3>
                            <p>Practice with previous year question papers to prepare for exams.</p>
                        </a>
                        
                        <a href="/seminar.html" class="nav-card" style="--card-color: #00b09b;">
                            <div class="nav-card-header">
                                <div class="nav-card-icon"><i class="fas fa-chalkboard-teacher"></i></div>
                                <span class="nav-card-arrow">→</span>
                            </div>
                            <h3>Seminars</h3>
                            <p>Watch recorded seminars and presentations from industry experts.</p>
                        </a>
                        
                        <a href="/quiz.html" class="nav-card" style="--card-color: #9b59b6;">
                            <div class="nav-card-header">
                                <div class="nav-card-icon"><i class="fas fa-question-circle"></i></div>
                                <span class="nav-card-arrow">→</span>
                            </div>
                            <h3>Quizzes</h3>
                            <p>Test your knowledge with interactive quizzes and assessments.</p>
                        </a>
                        
                        <a href="/cgpa.html" class="nav-card" style="--card-color: #ff6b6b;">
                            <div class="nav-card-header">
                                <div class="nav-card-icon"><i class="fas fa-calculator"></i></div>
                                <span class="nav-card-arrow">→</span>
                            </div>
                            <h3>GPA Calculator</h3>
                            <p>Calculate your Grade Point Average and track your academic progress.</p>
                        </a>
                    </section>
                </div>
                
                <!-- Badges Panel -->
                <div class="feature-panel" id="badges-panel">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-medal"></i> Achievement Badges</h2>
                        <div class="btn-secondary">
                            <i class="fas fa-trophy"></i> View All
                        </div>
                    </div>
                    
                    <div class="badges-container" id="badges-container">
                        <div class="spinner-container">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Resume Builder Panel -->
                <div class="feature-panel" id="resume-panel">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-file-alt"></i> Resume Builder</h2>
                        <button class="btn-primary" id="download-resume">
                            <i class="fas fa-download"></i> Download Resume
                        </button>
                    </div>
                    
                    <div class="resume-builder">
                        <div class="resume-sections">
                            <div class="resume-section active" data-section="personal">
                                <i class="fas fa-user"></i> Personal Information
                            </div>
                            <div class="resume-section" data-section="education">
                                <i class="fas fa-graduation-cap"></i> Education
                            </div>
                            <div class="resume-section" data-section="experience">
                                <i class="fas fa-briefcase"></i> Experience
                            </div>
                            <div class="resume-section" data-section="skills">
                                <i class="fas fa-cogs"></i> Skills
                            </div>
                            <div class="resume-section" data-section="projects">
                                <i class="fas fa-project-diagram"></i> Projects
                            </div>
                            <div class="resume-section" data-section="achievements">
                                <i class="fas fa-trophy"></i> Achievements
                            </div>
                        </div>
                        
                        <div class="resume-preview">
                            <!-- Personal Information Form -->
                            <div class="resume-form active" id="personal-form">
                                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Personal Information</h3>
                                <div class="form-group">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-input" id="resume-name" placeholder="Enter your full name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email Address</label>
                                    <input type="email" class="form-input" id="resume-email" placeholder="Enter your email">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-input" id="resume-phone" placeholder="Enter your phone number">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Professional Summary</label>
                                    <textarea class="form-textarea" id="resume-summary" placeholder="Write a brief professional summary"></textarea>
                                </div>
                                <button class="btn-primary" id="save-personal">Save Information</button>
                            </div>
                            
                            <!-- Education Form -->
                            <div class="resume-form" id="education-form">
                                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Education</h3>
                                <div class="form-group">
                                    <label class="form-label">Institution</label>
                                    <input type="text" class="form-input" id="resume-institution" placeholder="Enter institution name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Degree</label>
                                    <input type="text" class="form-input" id="resume-degree" placeholder="Enter your degree">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Graduation Year</label>
                                    <input type="text" class="form-input" id="resume-graduation" placeholder="Enter graduation year">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">GPA</label>
                                    <input type="text" class="form-input" id="resume-gpa" placeholder="Enter your GPA">
                                </div>
                                <button class="btn-primary" id="save-education">Save Education</button>
                            </div>
                            
                            <!-- Experience Form -->
                            <div class="resume-form" id="experience-form">
                                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Work Experience</h3>
                                <div class="form-group">
                                    <label class="form-label">Company</label>
                                    <input type="text" class="form-input" id="resume-company" placeholder="Enter company name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Position</label>
                                    <input type="text" class="form-input" id="resume-position" placeholder="Enter your position">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Duration</label>
                                    <input type="text" class="form-input" id="resume-duration" placeholder="Enter duration (e.g., June 2023 - August 2023)">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Responsibilities</label>
                                    <textarea class="form-textarea" id="resume-responsibilities" placeholder="List your key responsibilities"></textarea>
                                </div>
                                <button class="btn-primary" id="save-experience">Save Experience</button>
                            </div>
                            
                            <!-- Skills Form -->
                            <div class="resume-form" id="skills-form">
                                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Skills</h3>
                                <div class="form-group">
                                    <label class="form-label">Programming Languages</label>
                                    <input type="text" class="form-input" id="resume-languages" placeholder="Enter programming languages (comma separated)">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Web Technologies</label>
                                    <input type="text" class="form-input" id="resume-web-tech" placeholder="Enter web technologies (comma separated)">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Database</label>
                                    <input type="text" class="form-input" id="resume-database" placeholder="Enter database skills (comma separated)">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Tools & Software</label>
                                    <input type="text" class="form-input" id="resume-tools" placeholder="Enter tools and software (comma separated)">
                                </div>
                                <button class="btn-primary" id="save-skills">Save Skills</button>
                            </div>
                            
                            <!-- Projects Form -->
                            <div class="resume-form" id="projects-form">
                                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Projects</h3>
                                <div class="form-group">
                                    <label class="form-label">Project Name</label>
                                    <input type="text" class="form-input" id="resume-project-name" placeholder="Enter project name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Technologies Used</label>
                                    <input type="text" class="form-input" id="resume-project-tech" placeholder="Enter technologies used">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-textarea" id="resume-project-desc" placeholder="Describe your project"></textarea>
                                </div>
                                <button class="btn-primary" id="save-project">Save Project</button>
                            </div>
                            
                            <!-- Achievements Form -->
                            <div class="resume-form" id="achievements-form">
                                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Achievements</h3>
                                <div class="form-group">
                                    <label class="form-label">Achievement 1</label>
                                    <input type="text" class="form-input" id="resume-achievement1" placeholder="Enter achievement">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Achievement 2</label>
                                    <input type="text" class="form-input" id="resume-achievement2" placeholder="Enter achievement">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Achievement 3</label>
                                    <input type="text" class="form-input" id="resume-achievement3" placeholder="Enter achievement">
                                </div>
                                <button class="btn-primary" id="save-achievements">Save Achievements</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- AI Assistant Panel -->
                <div class="feature-panel" id="ai-assistant-panel">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-robot"></i> AI Learning Assistant</h2>
                        <div class="btn-secondary">
                            <i class="fas fa-cog"></i> Settings
                        </div>
                    </div>
                    
                    <div class="ai-assistant-container">
                        <div class="ai-chat">
                            <div class="ai-chat-header">
                                <div class="ai-avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Study Assistant</div>
                                    <div class="ai-status">
                                        <div class="status-dot"></div>
                                        Online
                                    </div>
                                </div>
                            </div>
                            
                            <div class="ai-messages" id="ai-messages">
                                <div class="message ai">
                                    <div class="message-bubble">
                                        Hello! I'm your AI learning assistant. How can I help you today?
                                    </div>
                                </div>
                            </div>
                            
                            <div class="ai-input-container">
                                <input type="text" class="ai-input" placeholder="Ask me anything..." id="ai-input">
                                <button class="ai-send" id="ai-send">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="ai-features">
                            <div class="ai-feature-title">AI Features</div>
                            <ul class="ai-feature-list">
                                <li class="ai-feature-item">
                                    <div class="ai-feature-icon">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <div class="ai-feature-name">Exam Preparation Coach</div>
                                </li>
                                <li class="ai-feature-item">
                                    <div class="ai-feature-icon">
                                        <i class="fas fa-comments"></i>
                                    </div>
                                    <div class="ai-feature-name">Emotion-Aware Chatbot</div>
                                </li>
                                <li class="ai-feature-item">
                                    <div class="ai-feature-icon">
                                        <i class="fas fa-microphone"></i>
                                    </div>
                                    <div class="ai-feature-name">Speech Recognition</div>
                                </li>
                                <li class="ai-feature-item">
                                    <div class="ai-feature-icon">
                                        <i class="fas fa-video"></i>
                                    </div>
                                    <div class="ai-feature-name">YouTube Video Assistant</div>
                                </li>
                                <li class="ai-feature-item">
                                    <div class="ai-feature-icon">
                                        <i class="fas fa-file-alt"></i>
                                    </div>
                                    <div class="ai-feature-name">Quiz Difficulty Adjuster</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Time Tracker Panel -->
                <div class="feature-panel" id="time-tracker-panel">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-stopwatch"></i> Time Tracker</h2>
                        <div class="btn-secondary">
                            <i class="fas fa-chart-bar"></i> Reports
                        </div>
                    </div>
                    
                    <div class="time-tracker-container">
                        <div class="tracker-timer">
                            <div style="font-size: 1.2rem; color: var(--text-secondary); margin-bottom: 10px;">Current Session</div>
                            <div class="timer-display" id="timer-display">00:00:00</div>
                            <div style="font-size: 1rem; color: var(--text-secondary); margin-bottom: 20px;" id="timer-activity">No activity selected</div>
                            
                            <div class="timer-controls">
                                <button class="timer-btn" id="timer-reset">
                                    <i class="fas fa-redo"></i>
                                </button>
                                <button class="timer-btn primary" id="timer-start">
                                    <i class="fas fa-play"></i>
                                </button>
                                <button class="timer-btn" id="timer-stop">
                                    <i class="fas fa-pause"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="tracker-activities">
                            <div class="activity-header">
                                <div class="activity-title">Study Activities</div>
                                <button class="btn-secondary" id="add-activity">
                                    <i class="fas fa-plus"></i> Add Activity
                                </button>
                            </div>
                            
                            <div class="activity-list" id="activity-list">
                                <div class="spinner-container">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Virtual Currency Panel -->
                <div class="feature-panel" id="credits-panel">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-coins"></i> Virtual Currency - Credits</h2>
                        <div class="btn-secondary">
                            <i class="fas fa-history"></i> Transaction History
                        </div>
                    </div>
                    
                    <div class="currency-container">
                        <div class="currency-balance">
                            <div class="currency-icon">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="currency-amount" id="currency-amount">0</div>
                            <div class="currency-label">Available Credits</div>
                            
                            <div class="currency-actions">
                                <button class="currency-btn earn" id="earn-credits">
                                    <i class="fas fa-plus"></i> Earn Credits
                                </button>
                                <button class="currency-btn spend" id="spend-credits">
                                    <i class="fas fa-shopping-cart"></i> Spend Credits
                                </button>
                            </div>
                        </div>
                        
                        <div class="currency-transactions">
                            <div class="transaction-header">
                                <div class="transaction-title">Recent Transactions</div>
                            </div>
                            
                            <div class="transaction-list" id="transaction-list">
                                <div class="spinner-container">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Leaderboard Panel -->
                <div class="feature-panel" id="leaderboard-panel">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-trophy"></i> Student Leaderboard</h2>
                        <div class="btn-secondary">
                            <i class="fas fa-filter"></i> Filter
                        </div>
                    </div>
                    
                    <div class="leaderboard-container">
                        <div class="leaderboard-rank">
                            <div class="rank-position" id="user-rank">#0</div>
                            <div class="rank-label">Your Rank</div>
                            <div class="rank-medal" id="user-medal">
                                <i class="fas fa-medal"></i>
                            </div>
                            <div style="margin-top: 20px; color: var(--text-secondary);">
                                <div id="user-points">0 Points</div>
                                <div style="font-size: 0.9rem; margin-top: 5px;" id="user-percentile">Top 100%</div>
                            </div>
                        </div>
                        
                        <div class="leaderboard-list">
                            <table class="leaderboard-table">
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Student</th>
                                        <th>Points</th>
                                    </tr>
                                </thead>
                                <tbody id="leaderboard-tbody">
                                    <tr>
                                        <td colspan="3" style="text-align: center; padding: 40px;">
                                            <div class="spinner-container">
                                                <div class="spinner"></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Profile Modal -->
        <div id="profile-modal" class="modal-overlay">
            <div class="modal">
                <div class="modal-header">
                    <h2><i class="fas fa-user"></i> Student Profile</h2>
                    <button id="profile-modal-close-btn" class="modal-close">&times;</button>
                </div>
                <div id="profile-content">
                    <div class="spinner-container">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Toast notification -->
        <div id="toast" class="toast">
            <i class="fas fa-check-circle"></i>
            <span id="toast-message">Notification message</span>
        </div>
    </main>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        // Initialize Firebase
        const firebaseConfig = { 
            apiKey: "AIzaSyDCmvA9sFCSc5r4ZuFUJuGdO1LDoW7rKao", 
            authDomain: "student-portal-free.firebaseapp.com", 
            projectId: "student-portal-free", 
            storageBucket: "student-portal-free.appspot.com", 
            messagingSenderId: "272865877510", 
            appId: "1:272865877510:web:0875a2502ae55bbf9ead87" 
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Global variables
        let currentUser = null;
        let userData = null;
        let lastNoticeTime = null;
        let timerInterval = null;
        let timerSeconds = 0;
        let timerRunning = false;
        let currentActivity = null;
        
        // DOM Elements
        const studentNameEl = document.getElementById('student-name');
        const logoutBtn = document.getElementById('logout-btn');
        const profileBtn = document.getElementById('profile-btn');
        const profileModal = document.getElementById('profile-modal');
        const profileModalCloseBtn = document.getElementById('profile-modal-close-btn');
        const profileContent = document.getElementById('profile-content');
        
        // Dashboard counters
        const materialsCount = document.getElementById('materials-count');
        const pyqsCount = document.getElementById('pyqs-count');
        const seminarsCount = document.getElementById('seminars-count');
        const creditsCount = document.getElementById('credits-count');
        
        // Feature tabs
        const featureTabs = document.querySelectorAll('.feature-tab');
        const featurePanels = document.querySelectorAll('.feature-panel');
        
        // Timer elements
        const timerDisplay = document.getElementById('timer-display');
        const timerActivity = document.getElementById('timer-activity');
        const timerStart = document.getElementById('timer-start');
        const timerStop = document.getElementById('timer-stop');
        const timerReset = document.getElementById('timer-reset');
        
        // AI Assistant elements
        const aiMessages = document.getElementById('ai-messages');
        const aiInput = document.getElementById('ai-input');
        const aiSend = document.getElementById('ai-send');
        
        // Resume Builder elements
        const resumeSections = document.querySelectorAll('.resume-section');
        const resumeForms = document.querySelectorAll('.resume-form');
        
        // Toast notification
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        
        // Enhanced toast function with auto-hide
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            toast.className = `toast ${type} show`;
            
            const icon = toast.querySelector('i');
            if (type === 'success') {
                icon.className = 'fas fa-check-circle';
            } else if (type === 'error') {
                icon.className = 'fas fa-exclamation-circle';
            } else if (type === 'info') {
                icon.className = 'fas fa-info-circle';
            }
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }
        
        // Format timestamp
        function formatTimestamp(timestamp) {
            if (!timestamp || !timestamp.toDate) return 'N/A';
            const date = timestamp.toDate();
            const now = new Date();
            const diffMs = now - date;
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                return 'Today ' + date.toLocaleTimeString('en-US', { 
                    hour: 'numeric', minute: '2-digit', hour12: true 
                });
            } else if (diffDays === 1) {
                return 'Yesterday';
            } else if (diffDays < 7) {
                return `${diffDays} days ago`;
            } else {
                return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
            }
        }
        
        // Format time
        function formatTime(seconds) {
            const hrs = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // Initialize page
        function initializePage() {
            // Logout functionality
            logoutBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to logout?')) {
                    auth.signOut().then(() => {
                        window.location.replace('/index.html');
                    }).catch(error => {
                        showToast("Logout failed. Please try again.", "error");
                    });
                }
            });
            
            // Profile modal
            profileBtn.addEventListener('click', () => {
                loadProfile();
                profileModal.classList.add('active');
            });
            
            profileModalCloseBtn.addEventListener('click', () => {
                profileModal.classList.remove('active');
            });
            
            profileModal.addEventListener('click', (e) => {
                if (e.target === profileModal) {
                    profileModal.classList.remove('active');
                }
            });
            
            // Feature tabs
            featureTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    featureTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Update active panel
                    featurePanels.forEach(panel => {
                        panel.classList.remove('active');
                        if (panel.id === `${tabId}-panel`) {
                            panel.classList.add('active');
                        }
                    });
                    
                    // Load panel-specific data
                    loadPanelData(tabId);
                });
            });
            
            // Timer functionality
            timerStart.addEventListener('click', () => {
                if (!timerRunning) {
                    timerRunning = true;
                    timerStart.innerHTML = '<i class="fas fa-pause"></i>';
                    
                    timerInterval = setInterval(() => {
                        timerSeconds++;
                        timerDisplay.textContent = formatTime(timerSeconds);
                    }, 1000);
                    
                    if (!currentActivity) {
                        currentActivity = 'General Study';
                        timerActivity.textContent = currentActivity;
                    }
                    
                    showToast('Timer started', 'info');
                } else {
                    timerRunning = false;
                    timerStart.innerHTML = '<i class="fas fa-play"></i>';
                    clearInterval(timerInterval);
                    
                    showToast('Timer paused', 'info');
                }
            });
            
            timerStop.addEventListener('click', () => {
                if (timerRunning) {
                    timerRunning = false;
                    timerStart.innerHTML = '<i class="fas fa-play"></i>';
                    clearInterval(timerInterval);
                    
                    // Save the session
                    saveTimeSession(timerSeconds, currentActivity);
                    
                    // Reset timer
                    timerSeconds = 0;
                    timerDisplay.textContent = formatTime(timerSeconds);
                    timerActivity.textContent = 'No activity selected';
                    currentActivity = null;
                    
                    showToast('Session saved successfully', 'success');
                }
            });
            
            timerReset.addEventListener('click', () => {
                if (timerRunning) {
                    timerRunning = false;
                    timerStart.innerHTML = '<i class="fas fa-play"></i>';
                    clearInterval(timerInterval);
                }
                
                timerSeconds = 0;
                timerDisplay.textContent = formatTime(timerSeconds);
                timerActivity.textContent = 'No activity selected';
                currentActivity = null;
                
                showToast('Timer reset', 'info');
            });
            
            // AI Assistant functionality
            aiSend.addEventListener('click', sendAiMessage);
            aiInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendAiMessage();
                }
            });
            
            // Resume Builder functionality
            resumeSections.forEach(section => {
                section.addEventListener('click', () => {
                    const sectionId = section.getAttribute('data-section');
                    
                    // Update active section
                    resumeSections.forEach(s => s.classList.remove('active'));
                    section.classList.add('active');
                    
                    // Update active form
                    resumeForms.forEach(form => {
                        form.classList.remove('active');
                        if (form.id === `${sectionId}-form`) {
                            form.classList.add('active');
                        }
                    });
                });
            });
            
            // Resume save buttons
            document.getElementById('save-personal').addEventListener('click', savePersonalInfo);
            document.getElementById('save-education').addEventListener('click', saveEducation);
            document.getElementById('save-experience').addEventListener('click', saveExperience);
            document.getElementById('save-skills').addEventListener('click', saveSkills);
            document.getElementById('save-project').addEventListener('click', saveProject);
            document.getElementById('save-achievements').addEventListener('click', saveAchievements);
            
            // Download resume
            document.getElementById('download-resume').addEventListener('click', downloadResume);
            
            // Virtual currency
            document.getElementById('earn-credits').addEventListener('click', earnCredits);
            document.getElementById('spend-credits').addEventListener('click', spendCredits);
            
            // Add activity
            document.getElementById('add-activity').addEventListener('click', addActivity);
            
            // Load dashboard data
            loadDashboardData();
        }
        
        // Load panel-specific data
        function loadPanelData(panelId) {
            switch(panelId) {
                case 'badges':
                    loadBadges();
                    break;
                case 'ai-assistant':
                    // AI assistant is already initialized
                    break;
                case 'time-tracker':
                    loadActivities();
                    break;
                case 'credits':
                    loadTransactions();
                    break;
                case 'leaderboard':
                    loadLeaderboard();
                    break;
            }
        }
        
        // Send AI message
        function sendAiMessage() {
            const message = aiInput.value.trim();
            if (!message) return;
            
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'message user';
            userMessage.innerHTML = `<div class="message-bubble">${message}</div>`;
            aiMessages.appendChild(userMessage);
            
            // Clear input
            aiInput.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                const aiMessage = document.createElement('div');
                aiMessage.className = 'message ai';
                
                // Simple response logic based on keywords
                let response = "I'm here to help with your studies. Could you provide more details?";
                
                if (message.toLowerCase().includes('recursion')) {
                    response = "Recursion is a programming technique where a function calls itself to solve a problem. It breaks down a complex problem into smaller, similar subproblems until reaching a base case that can be solved directly.";
                } else if (message.toLowerCase().includes('exam') || message.toLowerCase().includes('test')) {
                    response = "For exam preparation, I recommend creating a study schedule, reviewing class notes regularly, practicing with past papers, and taking breaks to avoid burnout. Would you like specific tips for a particular subject?";
                } else if (message.toLowerCase().includes('help') || message.toLowerCase().includes('stuck')) {
                    response = "I understand you're feeling stuck. Let's break this down. What specific topic or problem are you having trouble with? Sometimes explaining it step by step can help clarify things.";
                } else if (message.toLowerCase().includes('motivat')) {
                    response = "Remember, every expert was once a beginner. Progress might seem slow, but you're moving forward every day. Celebrate small victories and keep going! You've got this!";
                }
                
                aiMessage.innerHTML = `<div class="message-bubble">${response}</div>`;
                aiMessages.appendChild(aiMessage);
                
                // Scroll to bottom
                aiMessages.scrollTop = aiMessages.scrollHeight;
            }, 1000);
            
            // Scroll to bottom
            aiMessages.scrollTop = aiMessages.scrollHeight;
        }
        
        // Save time session
        function saveTimeSession(seconds, activity) {
            if (!currentUser) return;
            
            const session = {
                userId: currentUser.uid,
                activity: activity,
                duration: seconds,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            db.collection('timeSessions').add(session)
                .then(() => {
                    console.log('Time session saved successfully');
                })
                .catch(error => {
                    console.error('Error saving time session:', error);
                    showToast('Failed to save session', 'error');
                });
        }
        
        // Load user profile
        function loadProfile() {
            if (!currentUser) return;
            
            profileContent.innerHTML = '<div class="spinner-container"><div class="spinner"></div></div>';
            
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const data = doc.data();
                        const profileHtml = `
                            <div style="display: grid; grid-template-columns: auto 1fr; gap: 15px; margin-bottom: 20px;">
                                <div style="font-weight: 600; color: var(--text-secondary);">Full Name:</div>
                                <div>${data.name || 'Not provided'}</div>
                                
                                <div style="font-weight: 600; color: var(--text-secondary);">Email:</div>
                                <div>${currentUser.email}</div>
                                
                                <div style="font-weight: 600; color: var(--text-secondary);">Admission No:</div>
                                <div>${data.admissionNo || 'Not provided'}</div>
                                
                                <div style="font-weight: 600; color: var(--text-secondary);">Branch:</div>
                                <div>${data.branch || 'Not provided'}</div>
                                
                                <div style="font-weight: 600; color: var(--text-secondary);">Semester:</div>
                                <div>${data.semester || 'Not provided'}</div>
                                
                                <div style="font-weight: 600; color: var(--text-secondary);">Joined:</div>
                                <div>${formatTimestamp(data.createdAt)}</div>
                            </div>
                            
                            <div style="text-align: center; margin-top: 30px;">
                                <button class="btn-secondary" onclick="editProfile()">
                                    <i class="fas fa-edit"></i> Edit Profile
                                </button>
                            </div>
                        `;
                        
                        profileContent.innerHTML = profileHtml;
                    }
                })
                .catch(error => {
                    console.error('Error loading profile:', error);
                    profileContent.innerHTML = '<div class="empty-state"><p>Failed to load profile</p></div>';
                });
        }
        
        // Edit profile (placeholder function)
        function editProfile() {
            showToast('Edit profile feature coming soon!', 'info');
        }
        
        // Load dashboard data
        function loadDashboardData() {
            if (!currentUser) return;
            
            // Load materials count
            db.collection('notes').onSnapshot(snapshot => {
                materialsCount.textContent = snapshot.size;
            }, error => {
                console.error('Error loading materials:', error);
                materialsCount.textContent = 'Error';
            });
            
            // Load PYQs count
            db.collection('pyqs').onSnapshot(snapshot => {
                pyqsCount.textContent = snapshot.size;
            }, error => {
                console.error('Error loading PYQs:', error);
                pyqsCount.textContent = 'Error';
            });
            
            // Load seminars count
            db.collection('seminars').onSnapshot(snapshot => {
                seminarsCount.textContent = snapshot.size;
            }, error => {
                console.error('Error loading seminars:', error);
                seminarsCount.textContent = 'Error';
            });
            
            // Load user credits
            db.collection('users').doc(currentUser.uid).onSnapshot(doc => {
                if (doc.exists) {
                    const data = doc.data();
                    creditsCount.textContent = data.credits || 0;
                    userData = data;
                    studentNameEl.textContent = data.name || 'Student';
                }
            }, error => {
                console.error('Error loading user data:', error);
                creditsCount.textContent = 'Error';
            });
            
            // Load notices
            loadNotices();
            
            // Load recent materials
            loadRecentMaterials();
        }
        
        // Load notices with real-time updates
        function loadNotices() {
            const noticesList = document.getElementById('notices-list');
            const newNoticesBadge = document.getElementById('new-notices-badge');
            
            // Get last notice view time from localStorage
            lastNoticeTime = localStorage.getItem('lastNoticeTime');
            
            db.collection('notices')
                .orderBy('createdAt', 'desc')
                .limit(10)
                .onSnapshot(snapshot => {
                    const notices = [];
                    let hasNewNotices = false;
                    
                    snapshot.forEach(doc => {
                        const notice = doc.data();
                        notice.id = doc.id;
                        notices.push(notice);
                        
                        // Check if this is a new notice
                        if (lastNoticeTime && notice.createdAt && notice.createdAt.toDate()) {
                            const noticeTime = notice.createdAt.toDate().getTime();
                            const lastViewTime = parseInt(lastNoticeTime);
                            if (noticeTime > lastViewTime) {
                                hasNewNotices = true;
                            }
                        }
                    });
                    
                    // Show new notices badge if there are new notices
                    if (hasNewNotices) {
                        newNoticesBadge.style.display = 'block';
                    } else {
                        newNoticesBadge.style.display = 'none';
                    }
                    
                    if (notices.length === 0) {
                        noticesList.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon"><i class="fas fa-bullhorn"></i></div>
                                <p>No notices at the moment</p>
                            </div>
                        `;
                        return;
                    }
                    
                    const noticesHtml = notices.map(notice => {
                        const isImportant = notice.important || false;
                        const isNew = lastNoticeTime && notice.createdAt && notice.createdAt.toDate() && 
                                      notice.createdAt.toDate().getTime() > parseInt(lastNoticeTime);
                        
                        return `
                            <div class="notice-item ${isImportant ? 'important' : ''}">
                                <div class="notice-title">${notice.title || 'Untitled Notice'}</div>
                                <div class="notice-message">${notice.message || ''}</div>
                                <div class="notice-meta">
                                    <div class="notice-time">
                                        <i class="fas fa-clock"></i>
                                        ${formatTimestamp(notice.createdAt)}
                                    </div>
                                    ${isNew ? '<span class="notice-badge">NEW</span>' : ''}
                                </div>
                            </div>
                        `;
                    }).join('');
                    
                    noticesList.innerHTML = noticesHtml;
                    
                    // Mark notices as viewed when user scrolls to bottom
                    noticesList.addEventListener('scroll', () => {
                        if (noticesList.scrollTop + noticesList.clientHeight >= noticesList.scrollHeight - 50) {
                            localStorage.setItem('lastNoticeTime', Date.now().toString());
                            newNoticesBadge.style.display = 'none';
                            
                            // Remove NEW badges
                            document.querySelectorAll('.notice-badge').forEach(badge => {
                                badge.style.display = 'none';
                            });
                        }
                    });
                }, error => {
                    console.error('Error loading notices:', error);
                    noticesList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <p>Failed to load notices</p>
                        </div>
                    `;
                });
        }
        
        // Load recent materials with real-time updates
        function loadRecentMaterials() {
            const recentMaterials = document.getElementById('recent-materials');
            
            // Create a combined query for all materials
            const materialsPromises = [
                db.collection('notes').orderBy('createdAt', 'desc').limit(6).get(),
                db.collection('pyqs').orderBy('createdAt', 'desc').limit(6).get(),
                db.collection('seminars').orderBy('createdAt', 'desc').limit(6).get()
            ];
            
            Promise.all(materialsPromises).then(snapshots => {
                const allMaterials = [];
                
                // Process notes
                snapshots[0].forEach(doc => {
                    const data = doc.data();
                    allMaterials.push({
                        id: doc.id,
                        type: 'note',
                        title: data.title || 'Untitled',
                        details: data.details || data.description || 'No description',
                        createdAt: data.createdAt,
                        icon: 'fa-file-alt'
                    });
                });
                
                // Process PYQs
                snapshots[1].forEach(doc => {
                    const data = doc.data();
                    allMaterials.push({
                        id: doc.id,
                        type: 'pyq',
                        title: data.title || 'Untitled',
                        details: data.subject || 'No subject',
                        createdAt: data.createdAt,
                        icon: 'fa-file-alt'
                    });
                });
                
                // Process seminars
                snapshots[2].forEach(doc => {
                    const data = doc.data();
                    allMaterials.push({
                        id: doc.id,
                        type: 'seminar',
                        title: data.title || 'Untitled',
                        details: data.speaker || 'No speaker',
                        createdAt: data.createdAt,
                        icon: 'fa-chalkboard-teacher'
                    });
                });
                
                // Sort by creation date
                allMaterials.sort((a, b) => {
                    const aTime = a.createdAt ? a.createdAt.toDate() : new Date(0);
                    const bTime = b.createdAt ? b.createdAt.toDate() : new Date(0);
                    return bTime - aTime;
                });
                
                // Take only the latest 6
                const latestMaterials = allMaterials.slice(0, 6);
                
                if (latestMaterials.length === 0) {
                    recentMaterials.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-book"></i></div>
                            <p>No materials available</p>
                        </div>
                    `;
                    return;
                }
                
                const materialsHtml = latestMaterials.map(material => `
                    <div class="material-card">
                        <div class="material-icon">
                            <i class="fas ${material.icon}"></i>
                        </div>
                        <div class="material-title">${material.title}</div>
                        <div class="material-meta">
                            ${material.type.charAt(0).toUpperCase() + material.type.slice(1)} • 
                            ${formatTimestamp(material.createdAt)}
                        </div>
                    </div>
                `).join('');
                
                recentMaterials.innerHTML = materialsHtml;
            }).catch(error => {
                console.error('Error loading recent materials:', error);
                recentMaterials.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                        <p>Failed to load materials</p>
                    </div>
                `;
            });
        }
        
        // Load badges
        function loadBadges() {
            const badgesContainer = document.getElementById('badges-container');
            
            // Get user badges
            db.collection('users').doc(currentUser.uid).collection('badges').get()
                .then(snapshot => {
                    const userBadges = [];
                    snapshot.forEach(doc => {
                        userBadges.push(doc.id);
                    });
                    
                    // Get all badges
                    db.collection('badges').get()
                        .then(badgesSnapshot => {
                            const badges = [];
                            badgesSnapshot.forEach(doc => {
                                const badge = doc.data();
                                badge.id = doc.id;
                                badge.earned = userBadges.includes(doc.id);
                                badges.push(badge);
                            });
                            
                            if (badges.length === 0) {
                                badgesContainer.innerHTML = `
                                    <div class="empty-state">
                                        <div class="empty-icon"><i class="fas fa-medal"></i></div>
                                        <p>No badges available</p>
                                    </div>
                                `;
                                return;
                            }
                            
                            const badgesHtml = badges.map(badge => `
                                <div class="badge-item ${badge.earned ? 'badge-earned' : ''}">
                                    <div class="badge-icon">
                                        <i class="fas ${badge.icon || 'fa-star'}"></i>
                                    </div>
                                    <div class="badge-name">${badge.name}</div>
                                    <div class="badge-desc">${badge.description}</div>
                                </div>
                            `).join('');
                            
                            badgesContainer.innerHTML = badgesHtml;
                        })
                        .catch(error => {
                            console.error('Error loading badges:', error);
                            badgesContainer.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                                    <p>Failed to load badges</p>
                                </div>
                            `;
                        });
                })
                .catch(error => {
                    console.error('Error loading user badges:', error);
                    badgesContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <p>Failed to load badges</p>
                        </div>
                    `;
                });
        }
        
        // Load activities
        function loadActivities() {
            const activityList = document.getElementById('activity-list');
            
            db.collection('activities')
                .where('userId', '==', currentUser.uid)
                .orderBy('createdAt', 'desc')
                .onSnapshot(snapshot => {
                    const activities = [];
                    
                    snapshot.forEach(doc => {
                        const activity = doc.data();
                        activity.id = doc.id;
                        activities.push(activity);
                    });
                    
                    if (activities.length === 0) {
                        activityList.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon"><i class="fas fa-clock"></i></div>
                                <p>No activities yet</p>
                            </div>
                        `;
                        return;
                    }
                    
                    // Calculate total time for each activity
                    const activityTotals = {};
                    activities.forEach(activity => {
                        if (!activityTotals[activity.name]) {
                            activityTotals[activity.name] = 0;
                        }
                        activityTotals[activity.name] += activity.duration || 0;
                    });
                    
                    const activitiesHtml = Object.entries(activityTotals).map(([name, total]) => {
                        const hours = Math.floor(total / 3600);
                        const minutes = Math.floor((total % 3600) / 60);
                        const progress = Math.min((total / (20 * 3600)) * 100, 100); // 20 hours = 100%
                        
                        return `
                            <div class="activity-item">
                                <div>
                                    <div class="activity-name">${name}</div>
                                    <div class="activity-time">${hours}h ${minutes}m this week</div>
                                    <div class="activity-progress">
                                        <div class="activity-progress-bar" style="width: ${progress}%;"></div>
                                    </div>
                                </div>
                                <button class="btn-secondary" style="padding: 8px 12px; font-size: 0.9rem;" onclick="selectActivity('${name}')">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        `;
                    }).join('');
                    
                    activityList.innerHTML = activitiesHtml;
                }, error => {
                    console.error('Error loading activities:', error);
                    activityList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <p>Failed to load activities</p>
                        </div>
                    `;
                });
        }
        
        // Select activity for timer
        function selectActivity(name) {
            currentActivity = name;
            timerActivity.textContent = name;
            showToast(`Selected: ${name}`, 'info');
        }
        
        // Add new activity
        function addActivity() {
            const name = prompt('Enter activity name:');
            if (name && name.trim()) {
                db.collection('activities').add({
                    userId: currentUser.uid,
                    name: name.trim(),
                    duration: 0,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => {
                    showToast('Activity added successfully', 'success');
                }).catch(error => {
                    console.error('Error adding activity:', error);
                    showToast('Failed to add activity', 'error');
                });
            }
        }
        
        // Load transactions
        function loadTransactions() {
            const transactionList = document.getElementById('transaction-list');
            const currencyAmount = document.getElementById('currency-amount');
            
            // Get user credits
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const data = doc.data();
                        currencyAmount.textContent = data.credits || 0;
                    }
                });
            
            // Get transactions
            db.collection('transactions')
                .where('userId', '==', currentUser.uid)
                .orderBy('createdAt', 'desc')
                .limit(10)
                .onSnapshot(snapshot => {
                    const transactions = [];
                    
                    snapshot.forEach(doc => {
                        const transaction = doc.data();
                        transaction.id = doc.id;
                        transactions.push(transaction);
                    });
                    
                    if (transactions.length === 0) {
                        transactionList.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon"><i class="fas fa-coins"></i></div>
                                <p>No transactions yet</p>
                            </div>
                        `;
                        return;
                    }
                    
                    const transactionsHtml = transactions.map(transaction => `
                        <div class="transaction-item">
                            <div class="transaction-details">
                                <div class="transaction-icon ${transaction.type}">
                                    <i class="fas ${transaction.icon || 'fa-exchange-alt'}"></i>
                                </div>
                                <div class="transaction-info">
                                    <div class="transaction-desc">${transaction.description}</div>
                                    <div class="transaction-date">${formatTimestamp(transaction.createdAt)}</div>
                                </div>
                            </div>
                            <div class="transaction-amount ${transaction.type}">
                                ${transaction.type === 'earn' ? '+' : '-'}${transaction.amount}
                            </div>
                        </div>
                    `).join('');
                    
                    transactionList.innerHTML = transactionsHtml;
                }, error => {
                    console.error('Error loading transactions:', error);
                    transactionList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <p>Failed to load transactions</p>
                        </div>
                    `;
                });
        }
        
        // Earn credits
        function earnCredits() {
            const amount = parseInt(prompt('Enter amount to earn:'));
            if (amount && amount > 0) {
                const batch = db.batch();
                
                // Update user credits
                const userRef = db.collection('users').doc(currentUser.uid);
                batch.update(userRef, {
                    credits: firebase.firestore.FieldValue.increment(amount)
                });
                
                // Add transaction
                const transactionRef = db.collection('transactions').doc();
                batch.set(transactionRef, {
                    userId: currentUser.uid,
                    type: 'earn',
                    amount: amount,
                    description: 'Manual credit addition',
                    icon: 'fa-plus',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                batch.commit().then(() => {
                    showToast(`Earned ${amount} credits successfully`, 'success');
                }).catch(error => {
                    console.error('Error earning credits:', error);
                    showToast('Failed to earn credits', 'error');
                });
            }
        }
        
        // Spend credits
        function spendCredits() {
            const amount = parseInt(prompt('Enter amount to spend:'));
            if (amount && amount > 0) {
                // Check if user has enough credits
                db.collection('users').doc(currentUser.uid).get()
                    .then(doc => {
                        if (doc.exists) {
                            const currentCredits = doc.data().credits || 0;
                            if (currentCredits >= amount) {
                                const batch = db.batch();
                                
                                // Update user credits
                                const userRef = db.collection('users').doc(currentUser.uid);
                                batch.update(userRef, {
                                    credits: firebase.firestore.FieldValue.increment(-amount)
                                });
                                
                                // Add transaction
                                const transactionRef = db.collection('transactions').doc();
                                batch.set(transactionRef, {
                                    userId: currentUser.uid,
                                    type: 'spend',
                                    amount: amount,
                                    description: 'Manual credit deduction',
                                    icon: 'fa-minus',
                                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                                });
                                
                                batch.commit().then(() => {
                                    showToast(`Spent ${amount} credits successfully`, 'success');
                                }).catch(error => {
                                    console.error('Error spending credits:', error);
                                    showToast('Failed to spend credits', 'error');
                                });
                            } else {
                                showToast('Insufficient credits', 'error');
                            }
                        }
                    })
                    .catch(error => {
                        console.error('Error checking credits:', error);
                        showToast('Failed to spend credits', 'error');
                    });
            }
        }
        
        // Load leaderboard
        function loadLeaderboard() {
            const leaderboardTbody = document.getElementById('leaderboard-tbody');
            const userRank = document.getElementById('user-rank');
            const userPoints = document.getElementById('user-points');
            const userPercentile = document.getElementById('user-percentile');
            const userMedal = document.getElementById('user-medal');
            
            // Get leaderboard data
            db.collection('users')
                .orderBy('points', 'desc')
                .limit(20)
                .onSnapshot(snapshot => {
                    const users = [];
                    let currentUserRank = 0;
                    let currentUserData = null;
                    
                    snapshot.forEach((doc, index) => {
                        const user = doc.data();
                        user.id = doc.id;
                        user.rank = index + 1;
                        users.push(user);
                        
                        if (doc.id === currentUser.uid) {
                            currentUserRank = index + 1;
                            currentUserData = user;
                        }
                    });
                    
                    if (users.length === 0) {
                        leaderboardTbody.innerHTML = `
                            <tr>
                                <td colspan="3" style="text-align: center; padding: 40px;">
                                    <div class="empty-state">
                                        <div class="empty-icon"><i class="fas fa-trophy"></i></div>
                                        <p>No leaderboard data</p>
                                    </div>
                                </td>
                            </tr>
                        `;
                        return;
                    }
                    
                    // Update user rank display
                    if (currentUserData) {
                        userRank.textContent = `#${currentUserRank}`;
                        userPoints.textContent = `${currentUserData.points || 0} Points`;
                        
                        const percentile = Math.round((currentUserRank / users.length) * 100);
                        userPercentile.textContent = `Top ${percentile}%`;
                        
                        // Update medal
                        userMedal.className = 'rank-medal';
                        if (currentUserRank === 1) {
                            userMedal.classList.add('gold');
                            userMedal.innerHTML = '<i class="fas fa-medal"></i>';
                        } else if (currentUserRank === 2) {
                            userMedal.classList.add('silver');
                            userMedal.innerHTML = '<i class="fas fa-medal"></i>';
                        } else if (currentUserRank === 3) {
                            userMedal.classList.add('bronze');
                            userMedal.innerHTML = '<i class="fas fa-medal"></i>';
                        } else {
                            userMedal.innerHTML = '<i class="fas fa-award"></i>';
                        }
                    }
                    
                    // Generate leaderboard table
                    const leaderboardHtml = users.map(user => `
                        <tr class="${user.id === currentUser.uid ? 'current-user' : ''}">
                            <td class="leaderboard-rank-col">#${user.rank}</td>
                            <td class="leaderboard-name-col">${user.name || 'Anonymous'}</td>
                            <td class="leaderboard-score-col">${user.points || 0}</td>
                        </tr>
                    `).join('');
                    
                    leaderboardTbody.innerHTML = leaderboardHtml;
                }, error => {
                    console.error('Error loading leaderboard:', error);
                    leaderboardTbody.innerHTML = `
                        <tr>
                            <td colspan="3" style="text-align: center; padding: 40px;">
                                <div class="empty-state">
                                    <div class="empty-icon"><i class="fas fa-exclamation-circle"></i></div>
                                    <p>Failed to load leaderboard</p>
                                </div>
                            </td>
                        </tr>
                    `;
                });
        }
        
        // Resume Builder Functions
        function savePersonalInfo() {
            const data = {
                name: document.getElementById('resume-name').value,
                email: document.getElementById('resume-email').value,
                phone: document.getElementById('resume-phone').value,
                summary: document.getElementById('resume-summary').value
            };
            
            db.collection('users').doc(currentUser.uid).collection('resume').doc('personal').set(data)
                .then(() => {
                    showToast('Personal information saved', 'success');
                })
                .catch(error => {
                    console.error('Error saving personal info:', error);
                    showToast('Failed to save personal information', 'error');
                });
        }
        
        function saveEducation() {
            const data = {
                institution: document.getElementById('resume-institution').value,
                degree: document.getElementById('resume-degree').value,
                graduation: document.getElementById('resume-graduation').value,
                gpa: document.getElementById('resume-gpa').value
            };
            
            db.collection('users').doc(currentUser.uid).collection('resume').doc('education').set(data)
                .then(() => {
                    showToast('Education saved', 'success');
                })
                .catch(error => {
                    console.error('Error saving education:', error);
                    showToast('Failed to save education', 'error');
                });
        }
        
        function saveExperience() {
            const data = {
                company: document.getElementById('resume-company').value,
                position: document.getElementById('resume-position').value,
                duration: document.getElementById('resume-duration').value,
                responsibilities: document.getElementById('resume-responsibilities').value
            };
            
            db.collection('users').doc(currentUser.uid).collection('resume').doc('experience').set(data)
                .then(() => {
                    showToast('Experience saved', 'success');
                })
                .catch(error => {
                    console.error('Error saving experience:', error);
                    showToast('Failed to save experience', 'error');
                });
        }
        
        function saveSkills() {
            const data = {
                languages: document.getElementById('resume-languages').value,
                webTech: document.getElementById('resume-web-tech').value,
                database: document.getElementById('resume-database').value,
                tools: document.getElementById('resume-tools').value
            };
            
            db.collection('users').doc(currentUser.uid).collection('resume').doc('skills').set(data)
                .then(() => {
                    showToast('Skills saved', 'success');
                })
                .catch(error => {
                    console.error('Error saving skills:', error);
                    showToast('Failed to save skills', 'error');
                });
        }
        
        function saveProject() {
            const data = {
                name: document.getElementById('resume-project-name').value,
                tech: document.getElementById('resume-project-tech').value,
                description: document.getElementById('resume-project-desc').value
            };
            
            db.collection('users').doc(currentUser.uid).collection('resume').doc('project').set(data)
                .then(() => {
                    showToast('Project saved', 'success');
                })
                .catch(error => {
                    console.error('Error saving project:', error);
                    showToast('Failed to save project', 'error');
                });
        }
        
        function saveAchievements() {
            const data = {
                achievement1: document.getElementById('resume-achievement1').value,
                achievement2: document.getElementById('resume-achievement2').value,
                achievement3: document.getElementById('resume-achievement3').value
            };
            
            db.collection('users').doc(currentUser.uid).collection('resume').doc('achievements').set(data)
                .then(() => {
                    showToast('Achievements saved', 'success');
                })
                .catch(error => {
                    console.error('Error saving achievements:', error);
                    showToast('Failed to save achievements', 'error');
                });
        }
        
        function downloadResume() {
            showToast('Resume download feature coming soon!', 'info');
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Escape key closes modals
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal-overlay.active').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
        });
        
        // Authentication check
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                
                // Get user data
                db.collection('users').doc(user.uid).get().then(doc => {
                    if (doc.exists) {
                        userData = doc.data();
                        studentNameEl.textContent = userData.name || 'Student';
                    } else {
                        studentNameEl.textContent = 'Student';
                    }
                    
                    // Initialize page
                    initializePage();
                }).catch(error => {
                    console.error('Error getting user data:', error);
                    studentNameEl.textContent = 'Student';
                    initializePage();
                });
            } else {
                // Redirect to login page
                window.location.replace('/index.html');
            }
        });
        
        // Console welcome message
        console.log('%cIB STUDIOZ Student Dashboard', 'color: #FFD700; font-size: 24px; font-weight: bold;');
        console.log('%cWelcome to your personalized learning dashboard', 'color: #00A2FF; font-size: 14px;');
        console.log('Real-time Firebase integration active ✓');
    </script>
</body>
</html>
